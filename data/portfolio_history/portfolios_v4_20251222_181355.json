{
  "version": "v4.8.7",
  "timestamp": "20251222_181355",
  "date": "2025-12-22T18:13:55.330823",
  "buffett_config": {
    "mode": "soft",
    "min_score": 40
  },
  "tactical_config": {
    "enabled": true,
    "data_dir": "data"
  },
  "backtest_config": {
    "days": 90,
    "freq": "M",
    "platform_fee_annual_bp": 0.0,
    "ter_handling": "embedded_in_etf_prices"
  },
  "portfolios": {
    "Agressif": {
      "allocation": {
        "VanEck Biotech ETF": 15.0,
        "ProShares Ultra QQQ": 5.0,
        "VanEck J.P. Morgan EM Local Currency Bond ETF": 5.0,
        "iShares Convertible Bond ETF": 5.0,
        "iShares J.P. Morgan EM Local Currency Bond ETF": 5.0,
        "iShares 3 Year International Treasury Bond ETF": 3.98,
        "iShares Silver Trust": 1.02,
        "STETH/USD": 10.0,
        "EQ_641": 15.0,
        "EQ_10": 15.0,
        "EQ_555": 6.02,
        "EQ_537": 13.98
      },
      "diagnostics": {
        "converged": true,
        "optimization_mode": "slsqp",
        "fallback_reason": null,
        "fallback_heuristic": false,
        "heuristic_name": null,
        "heuristic_version": null,
        "rules_applied": null,
        "rules_parameters": null,
        "why_not_slsqp": null,
        "why_not_slsqp_details": null,
        "message": "SLSQP converged",
        "portfolio_vol": 17.71,
        "vol_target": 18.0,
        "vol_tolerance": 3.0,
        "vol_diff": -0.29,
        "portfolio_score": 10.811,
        "n_assets": 12,
        "n_bonds": 4,
        "n_crypto": 1,
        "crypto_max_allowed": 10.0,
        "sectors": {
          "Diversified": 21.02,
          "Bonds": 18.98,
          "Crypto": 10.0,
          "Finance": 35.0,
          "Sant√©": 15.0
        },
        "bucket_exposure": {
          "satellite": 56.019999999999996,
          "defensive": 18.98,
          "core": 25.0
        },
        "bucket_compliance": {
          "core": {
            "actual": 25.0,
            "target_min": 30.0,
            "target_max": 45.0,
            "in_range": true
          },
          "satellite": {
            "actual": 56.0,
            "target_min": 35.0,
            "target_max": 60.0,
            "in_range": true
          },
          "defensive": {
            "actual": 19.0,
            "target_min": 5.0,
            "target_max": 15.0,
            "in_range": true
          },
          "lottery": {
            "actual": 0.0,
            "target_min": 0.0,
            "target_max": 5.0,
            "in_range": true
          }
        },
        "corporate_group_exposure": {},
        "covariance_method": "structured+diag_shrink",
        "covariance_empirical_weight": 0.0,
        "covariance_kpis": {
          "condition_number": 1902.44,
          "condition_number_before_shrinkage": null,
          "shrinkage_applied": false,
          "shrinkage_intensity": 0.0,
          "eigen_clipped": 0,
          "eigen_clipped_pct": 0.0,
          "eigenvalue_min": 0.0008854109367748784,
          "eigenvalue_max": 1.684436810281208,
          "eigenvalue_min_raw": 0.0008854109367748784,
          "matrix_size": 54,
          "is_well_conditioned": true,
          "thresholds": {
            "condition_number_warning": 10000.0,
            "eigen_clipped_pct_warning": 20.0
          }
        },
        "buffett_hard_filter_enabled": true,
        "buffett_min_score": 50.0,
        "constraint_report": {
          "profile_name": "Agressif",
          "constraints": [
            {
              "name": "volatility",
              "constraint_type": "target",
              "cap": 18.0,
              "observed": 17.71,
              "slack": 2.71,
              "binding": false,
              "status": "OK",
              "details": {
                "tolerance": 3.0,
                "range_min": 15.0,
                "range_max": 21.0,
                "diff_from_target": -0.29
              }
            },
            {
              "name": "bonds_min",
              "constraint_type": "min",
              "cap": 5.0,
              "observed": 18.98,
              "slack": 13.98,
              "binding": false,
              "status": "OK",
              "details": {
                "count": 4,
                "breakdown": [
                  {
                    "id": "VanEck J.P. Morgan EM Local Currency Bond ETF",
                    "name": "VanEck J.P. Morgan EM Local Cu",
                    "weight": 5.0
                  },
                  {
                    "id": "iShares Convertible Bond ETF",
                    "name": "iShares Convertible Bond ETF",
                    "weight": 5.0
                  },
                  {
                    "id": "iShares J.P. Morgan EM Local Currency Bond ETF",
                    "name": "iShares J.P. Morgan EM Local C",
                    "weight": 5.0
                  },
                  {
                    "id": "iShares 3 Year International Treasury Bond ETF",
                    "name": "iShares 3 Year International T",
                    "weight": 3.98
                  }
                ]
              }
            },
            {
              "name": "crypto_max",
              "constraint_type": "max",
              "cap": 10.0,
              "observed": 10.0,
              "slack": 0.0,
              "binding": true,
              "status": "BINDING",
              "details": {
                "breakdown": [
                  {
                    "id": "STETH/USD",
                    "name": "STETH/USD",
                    "weight": 10.0
                  }
                ]
              }
            },
            {
              "name": "max_single_position",
              "constraint_type": "max",
              "cap": 15.0,
              "observed": 15.0,
              "slack": 0.0,
              "binding": true,
              "status": "BINDING",
              "details": {
                "largest_position": {
                  "id": "VanEck Biotech ETF",
                  "name": "VanEck Biotech ETF",
                  "weight": 15.0
                },
                "positions_above_10pct": [
                  {
                    "id": "VanEck Biotech ETF",
                    "weight": 15.0
                  },
                  {
                    "id": "EQ_641",
                    "weight": 15.0
                  },
                  {
                    "id": "EQ_10",
                    "weight": 15.0
                  },
                  {
                    "id": "EQ_537",
                    "weight": 13.98
                  }
                ]
              }
            },
            {
              "name": "max_sector",
              "constraint_type": "max",
              "cap": 35.0,
              "observed": 35.0,
              "slack": 0.0,
              "binding": true,
              "status": "BINDING",
              "details": {
                "most_concentrated": "Finance",
                "counts_in_max_sector": {
                  "Finance": 35.0,
                  "Diversified": 20.0,
                  "Sant√©": 15.0
                },
                "all_sectors": {
                  "Finance": 35.0,
                  "Diversified": 21.02,
                  "Bonds": 18.98,
                  "Sant√©": 15.0,
                  "Crypto": 10.0
                },
                "scope": "EQUITY_LIKE only (excludes Bonds)"
              }
            },
            {
              "name": "max_region",
              "constraint_type": "max",
              "cap": 50.0,
              "observed": 20.0,
              "slack": 30.0,
              "binding": false,
              "status": "OK",
              "details": {
                "most_concentrated": "Global",
                "counts_in_max_region": {
                  "Global": 20.0,
                  "Irlande": 15.0,
                  "Etats-Unis": 15.0,
                  "Allemagne": 13.98,
                  "Italie": 6.02
                },
                "all_regions": {
                  "Global": 50.0,
                  "Irlande": 15.0,
                  "Etats-Unis": 15.0,
                  "Allemagne": 13.98,
                  "Italie": 6.02
                },
                "scope": "EQUITY_LIKE + LEVERAGED only"
              }
            },
            {
              "name": "min_assets",
              "constraint_type": "min",
              "cap": 10,
              "observed": 12,
              "slack": 2,
              "binding": false,
              "status": "OK",
              "details": {}
            },
            {
              "name": "max_assets",
              "constraint_type": "max",
              "cap": 18,
              "observed": 12,
              "slack": 6,
              "binding": false,
              "status": "OK",
              "details": {}
            },
            {
              "name": "bucket_core",
              "constraint_type": "range",
              "cap": 45.0,
              "observed": 25.0,
              "slack": -5.0,
              "binding": false,
              "status": "OK",
              "details": {
                "range_min": 30.0,
                "range_max": 45.0,
                "slack_from_min": -5.0,
                "slack_from_max": 20.0,
                "outside_range": true,
                "is_indicator": true
              }
            },
            {
              "name": "bucket_satellite",
              "constraint_type": "range",
              "cap": 60.0,
              "observed": 56.02,
              "slack": 3.98,
              "binding": false,
              "status": "OK",
              "details": {
                "range_min": 35.0,
                "range_max": 60.0,
                "slack_from_min": 21.02,
                "slack_from_max": 3.98,
                "outside_range": false,
                "is_indicator": true
              }
            },
            {
              "name": "bucket_defensive",
              "constraint_type": "range",
              "cap": 15.0,
              "observed": 18.98,
              "slack": -3.98,
              "binding": false,
              "status": "OK",
              "details": {
                "range_min": 5.0,
                "range_max": 15.0,
                "slack_from_min": 13.98,
                "slack_from_max": -3.98,
                "outside_range": true,
                "is_indicator": true
              }
            },
            {
              "name": "bucket_lottery",
              "constraint_type": "range",
              "cap": 5.0,
              "observed": 0,
              "slack": 0.0,
              "binding": true,
              "status": "BINDING",
              "details": {
                "range_min": 0.0,
                "range_max": 5.0,
                "slack_from_min": 0.0,
                "slack_from_max": 5.0,
                "outside_range": false,
                "is_indicator": true
              }
            },
            {
              "name": "leveraged_cap",
              "constraint_type": "max",
              "cap": 5.0,
              "observed": 5.0,
              "slack": 0.0,
              "binding": true,
              "status": "BINDING",
              "details": {}
            },
            {
              "name": "alternative_cap",
              "constraint_type": "max",
              "cap": 20.0,
              "observed": 0,
              "slack": 20.0,
              "binding": false,
              "status": "OK",
              "details": {
                "includes": [
                  "Derivative Income",
                  "Defined Outcome",
                  "Allocation funds"
                ]
              }
            }
          ],
          "summary": {
            "total": 14,
            "ok": 10,
            "binding": 4,
            "violated": 0,
            "critical": 0
          },
          "quality_score": 94.3,
          "recommendations": [
            "üü° BINDING: crypto_max at 10.0% (cap=10.0%) ‚Äî monitor closely",
            "üü° BINDING: max_single_position at 15.0% (cap=15.0%) ‚Äî monitor closely",
            "üü° BINDING: max_sector at 35.0% (cap=35.0%) ‚Äî monitor closely",
            "üü° BINDING: leveraged_cap at 5.0% (cap=5.0%) ‚Äî monitor closely",
            "‚ö†Ô∏è 4 constraints are binding ‚Äî consider relaxing profile or reducing positions"
          ],
          "exposures": {
            "by_category": {
              "ETF": 21.02,
              "Obligations": 18.98,
              "Crypto": 10.0,
              "Actions": 50.0
            },
            "by_sector": {
              "Finance": 35.0,
              "Diversified": 21.02,
              "Sant√©": 15.0
            },
            "by_region": {
              "Global": 50.0,
              "Irlande": 15.0,
              "Etats-Unis": 15.0,
              "Allemagne": 13.98,
              "Italie": 6.02
            },
            "by_risk_bucket": {
              "equity_like": 65.0,
              "leveraged": 5.0,
              "bond_like": 18.98,
              "real_assets": 1.02,
              "crypto": 10.0
            },
            "by_role": {
              "core": 25.0,
              "satellite": 56.02,
              "defensive": 18.98,
              "lottery": 0.0,
              "unknown": 0.0
            },
            "concentration": {
              "hhi": 1124.0,
              "hhi_interpretation": "diversified",
              "effective_n": 8.9,
              "n_positions": 12,
              "top_5_weight": 68.98,
              "top_10_weight": 95.0,
              "largest_position": 15.0,
              "smallest_position": 1.02,
              "thresholds": {
                "well_diversified": "HHI < 1000",
                "diversified": "HHI 1000-1500",
                "moderately_concentrated": "HHI 1500-2500",
                "highly_concentrated": "HHI > 2500"
              },
              "source": "exposures.py"
            }
          },
          "ticker_mapping": [
            {
              "id": "VanEck Biotech ETF",
              "ticker": "BBH",
              "isin": NaN,
              "name": "VanEck Biotech ETF",
              "weight_pct": 15.0,
              "category": "ETF",
              "risk_bucket": "equity_like",
              "sector": "Diversified",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "EQ_641",
              "ticker": "A5G",
              "isin": null,
              "name": "AIB GROUP PLC",
              "weight_pct": 15.0,
              "category": "Actions",
              "risk_bucket": "equity_like",
              "sector": "Finance",
              "region": "Irlande",
              "exchange": null
            },
            {
              "id": "EQ_10",
              "ticker": "LLY",
              "isin": null,
              "name": "ELI LILLY",
              "weight_pct": 15.0,
              "category": "Actions",
              "risk_bucket": "equity_like",
              "sector": "Sant√©",
              "region": "Etats-Unis",
              "exchange": null
            },
            {
              "id": "EQ_537",
              "ticker": "ALV",
              "isin": null,
              "name": "ALLIANZ",
              "weight_pct": 13.98,
              "category": "Actions",
              "risk_bucket": "equity_like",
              "sector": "Finance",
              "region": "Allemagne",
              "exchange": null
            },
            {
              "id": "STETH/USD",
              "ticker": "STETH/USD",
              "isin": null,
              "name": "STETH/USD",
              "weight_pct": 10.0,
              "category": "Crypto",
              "risk_bucket": "crypto",
              "sector": "Crypto",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "EQ_555",
              "ticker": "UCG",
              "isin": null,
              "name": "UNICREDIT",
              "weight_pct": 6.02,
              "category": "Actions",
              "risk_bucket": "equity_like",
              "sector": "Finance",
              "region": "Italie",
              "exchange": null
            },
            {
              "id": "ProShares Ultra QQQ",
              "ticker": "QLD",
              "isin": NaN,
              "name": "ProShares Ultra QQQ",
              "weight_pct": 5.0,
              "category": "ETF",
              "risk_bucket": "leveraged",
              "sector": "Diversified",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "VanEck J.P. Morgan EM Local Currency Bond ETF",
              "ticker": "EMLC",
              "isin": NaN,
              "name": "VanEck J.P. Morgan EM Local Currency Bond ETF",
              "weight_pct": 5.0,
              "category": "Obligations",
              "risk_bucket": "bond_like",
              "sector": "Bonds",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "iShares Convertible Bond ETF",
              "ticker": "ICVT",
              "isin": NaN,
              "name": "iShares Convertible Bond ETF",
              "weight_pct": 5.0,
              "category": "Obligations",
              "risk_bucket": "bond_like",
              "sector": "Bonds",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "iShares J.P. Morgan EM Local Currency Bond ETF",
              "ticker": "LEMB",
              "isin": NaN,
              "name": "iShares J.P. Morgan EM Local Currency Bond ETF",
              "weight_pct": 5.0,
              "category": "Obligations",
              "risk_bucket": "bond_like",
              "sector": "Bonds",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "iShares 3 Year International Treasury Bond ETF",
              "ticker": "ISHG",
              "isin": NaN,
              "name": "iShares 3 Year International Treasury Bond ETF",
              "weight_pct": 3.98,
              "category": "Obligations",
              "risk_bucket": "bond_like",
              "sector": "Bonds",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "iShares Silver Trust",
              "ticker": "SLV",
              "isin": NaN,
              "name": "iShares Silver Trust",
              "weight_pct": 1.02,
              "category": "ETF",
              "risk_bucket": "real_assets",
              "sector": "Diversified",
              "region": "Global",
              "exchange": null
            }
          ],
          "execution_summary": {
            "n_positions": 12,
            "n_exchanges": 0,
            "exchanges": [],
            "total_weight": 100.0,
            "missing_isin": 5,
            "missing_ticker": 0,
            "data_quality": {
              "isin_coverage": 58.3,
              "ticker_coverage": 100.0
            },
            "ready_for_execution": true
          }
        },
        "constraint_summary": {
          "total": 14,
          "ok": 10,
          "binding": 4,
          "violated": 0,
          "critical": 0
        },
        "constraint_quality_score": 94.3,
        "constraint_violations": [],
        "constraint_bindings": [
          {
            "name": "crypto_max",
            "constraint_type": "max",
            "cap": 10.0,
            "observed": 10.0,
            "slack": 0.0,
            "binding": true,
            "status": "BINDING",
            "details": {
              "breakdown": [
                {
                  "id": "STETH/USD",
                  "name": "STETH/USD",
                  "weight": 10.0
                }
              ]
            }
          },
          {
            "name": "max_single_position",
            "constraint_type": "max",
            "cap": 15.0,
            "observed": 15.0,
            "slack": 0.0,
            "binding": true,
            "status": "BINDING",
            "details": {
              "largest_position": {
                "id": "VanEck Biotech ETF",
                "name": "VanEck Biotech ETF",
                "weight": 15.0
              },
              "positions_above_10pct": [
                {
                  "id": "VanEck Biotech ETF",
                  "weight": 15.0
                },
                {
                  "id": "EQ_641",
                  "weight": 15.0
                },
                {
                  "id": "EQ_10",
                  "weight": 15.0
                },
                {
                  "id": "EQ_537",
                  "weight": 13.98
                }
              ]
            }
          },
          {
            "name": "max_sector",
            "constraint_type": "max",
            "cap": 35.0,
            "observed": 35.0,
            "slack": 0.0,
            "binding": true,
            "status": "BINDING",
            "details": {
              "most_concentrated": "Finance",
              "counts_in_max_sector": {
                "Finance": 35.0,
                "Diversified": 20.0,
                "Sant√©": 15.0
              },
              "all_sectors": {
                "Finance": 35.0,
                "Diversified": 21.02,
                "Bonds": 18.98,
                "Sant√©": 15.0,
                "Crypto": 10.0
              },
              "scope": "EQUITY_LIKE only (excludes Bonds)"
            }
          },
          {
            "name": "bucket_lottery",
            "constraint_type": "range",
            "cap": 5.0,
            "observed": 0,
            "slack": 0.0,
            "binding": true,
            "status": "BINDING",
            "details": {
              "range_min": 0.0,
              "range_max": 5.0,
              "slack_from_min": 0.0,
              "slack_from_max": 5.0,
              "outside_range": false,
              "is_indicator": true
            }
          },
          {
            "name": "leveraged_cap",
            "constraint_type": "max",
            "cap": 5.0,
            "observed": 5.0,
            "slack": 0.0,
            "binding": true,
            "status": "BINDING",
            "details": {}
          }
        ],
        "exposures": {
          "by_category": {
            "ETF": 21.02,
            "Obligations": 18.98,
            "Crypto": 10.0,
            "Actions": 50.0
          },
          "by_sector": {
            "Finance": 35.0,
            "Diversified": 21.02,
            "Sant√©": 15.0
          },
          "by_region": {
            "Global": 50.0,
            "Irlande": 15.0,
            "Etats-Unis": 15.0,
            "Allemagne": 13.98,
            "Italie": 6.02
          },
          "by_risk_bucket": {
            "equity_like": 65.0,
            "leveraged": 5.0,
            "bond_like": 18.98,
            "real_assets": 1.02,
            "crypto": 10.0
          },
          "by_role": {
            "core": 25.0,
            "satellite": 56.02,
            "defensive": 18.98,
            "lottery": 0.0,
            "unknown": 0.0
          },
          "concentration": {
            "hhi": 1124.0,
            "hhi_interpretation": "diversified",
            "effective_n": 8.9,
            "n_positions": 12,
            "top_5_weight": 68.98,
            "top_10_weight": 95.0,
            "largest_position": 15.0,
            "smallest_position": 1.02,
            "thresholds": {
              "well_diversified": "HHI < 1000",
              "diversified": "HHI 1000-1500",
              "moderately_concentrated": "HHI 1500-2500",
              "highly_concentrated": "HHI > 2500"
            },
            "source": "exposures.py"
          }
        },
        "execution_summary": {
          "n_positions": 12,
          "n_exchanges": 0,
          "exchanges": [],
          "total_weight": 100.0,
          "missing_isin": 5,
          "missing_ticker": 0,
          "data_quality": {
            "isin_coverage": 58.3,
            "ticker_coverage": 100.0
          },
          "ready_for_execution": true
        },
        "_feasibility": {
          "feasible": true,
          "reason": null,
          "capacity": {
            "bonds": 9075.0,
            "n_candidates": 1719,
            "vol_range": "1%-150%"
          },
          "requirements": {
            "bonds_min": 5.0,
            "min_assets": 10,
            "vol_target": "18.0% ¬±3.0%"
          }
        },
        "llm_sanitizer": {
          "profile": "Agressif",
          "justifications_cleaned": 0,
          "total_hits": 0,
          "total_warnings": 0,
          "hit_labels": [],
          "used_fallback": false
        },
        "used_fallback_comment": false
      },
      "justifications": {
        "VanEck Biotech ETF": "Ce fonds investit dans des entreprises du secteur biopharmaceutique, qui peuvent √™tre volatiles en raison de la r√©glementation et des innovations technologiques. [TH]",
        "AIB GROUP PLC": "Cette action est expos√©e aux fluctuations √©conomiques en Europe, ce qui peut affecter sa performance. [MC]",
        "ELI LILLY": "L'entreprise est soumise aux risques li√©s √† la recherche et d√©veloppement, pouvant impacter ses r√©sultats. [SEC]",
        "ALLIANZ": "L'assureur est sensible aux variations des taux d'int√©r√™t et aux conditions √©conomiques globales. [MC]",
        "STETH/USD": "Les cryptomonnaies pr√©sentent une volatilit√© √©lev√©e, ce qui peut affecter la stabilit√© du portefeuille. [TH]",
        "UNICREDIT": "Cette banque est expos√©e aux risques de cr√©dit et aux fluctuations du march√© financier. [MC]",
        "ProShares Ultra QQQ": "Ce fonds peut √™tre affect√© par la volatilit√© des actions technologiques, qui sont sensibles aux tendances du march√©. [MC]",
        "VanEck J.P. Morgan EM Local Currency Bond ETF": "Les obligations en devises √©mergentes peuvent √™tre affect√©es par des fluctuations mon√©taires. [SEC]",
        "iShares Convertible Bond ETF": "Les obligations convertibles sont sensibles aux variations des taux d'int√©r√™t et des actions sous-jacentes. [SEC]",
        "iShares J.P. Morgan EM Local Currency Bond ETF": "Les risques de change peuvent impacter la performance de ce fonds. [SEC]",
        "iShares 3 Year International Treasury Bond ETF": "Les obligations √† court terme peuvent offrir des rendements limit√©s en p√©riode de hausse des taux. [MC]",
        "iShares Silver Trust": "L'argent peut √™tre volatile en raison des fluctuations des prix des mati√®res premi√®res. [TH]"
      },
      "comment": "Ce portefeuille mod√®le pr√©sente une exposition significative √† des actifs √† forte volatilit√©, notamment dans le secteur des technologies et des cryptomonnaies. Bien qu'il vise √† g√©n√©rer des rendements √©lev√©s, il est important de noter que les fluctuations du march√© peuvent entra√Æner des pertes. De plus, la concentration dans possibles secteurs, comme la finance et la sant√©, expose le portefeuille √† des risques sp√©cifiques. Les investisseurs doivent √™tre conscients des risques associ√©s √† ces types d'actifs avant de prendre des d√©cisions. ‚ö†Ô∏è Performances calcul√©es sur 90 jours, hors frais de transaction et fiscalit√©. Sharpe ratio annualis√© sur p√©riode courte (non repr√©sentatif long terme). Les performances pass√©es ne pr√©jugent pas des performances futures.",
      "compliance": "‚ö†Ô∏è AVERTISSEMENT : Ce portefeuille est g√©n√©r√© √† titre informatif uniquement et ne constitue pas un conseil en investissement. Les performances pass√©es ne pr√©jugent pas des performances futures. Investir comporte des risques de perte en capital. Consultez un conseiller financier agr√©√© avant toute d√©cision d'investissement.\n\nüî¥ PROFIL AGRESSIF : Ce portefeuille pr√©sente un niveau de risque √©lev√©. Il est destin√© aux investisseurs ayant une tol√©rance au risque importante et un horizon d'investissement long terme (>5 ans).\n\nüìä Volatilit√© estim√©e : 17.7% (mod√©r√©e).\n\n‚Çø EXPOSITION CRYPTO (10.0%) : Les crypto-actifs sont des actifs hautement sp√©culatifs et volatils. Ils ne sont pas r√©gul√©s et pr√©sentent un risque de perte totale du capital investi.",
      "_compliance_audit": {
        "llm_sanitizer": {
          "sanitized": false,
          "removed_sentences": 0,
          "hits": [],
          "warnings": [],
          "removal_ratio": 0.0,
          "original_length": 542,
          "sanitized_length": 542
        },
        "timestamp": "2025-12-22T18:13:55.311935",
        "version": "v4.8.7",
        "fallback_used": false
      }
    },
    "Mod√©r√©": {
      "allocation": {
        "BTC/USD": 5.0,
        "iShares 3 Year International Treasury Bond ETF": 8.0,
        "VanEck J.P. Morgan EM Local Currency Bond ETF": 8.0,
        "iShares J.P. Morgan EM Local Currency Bond ETF": 8.0,
        "abrdn Physical Precious Metals Basket Shares ETF": 15.0,
        "iShares Silver Trust": 6.0,
        "EQ_641": 15.0,
        "EQ_537": 15.0,
        "EQ_562": 15.0,
        "EQ_13": 5.0
      },
      "diagnostics": {
        "converged": true,
        "optimization_mode": "slsqp",
        "fallback_reason": null,
        "fallback_heuristic": false,
        "heuristic_name": null,
        "heuristic_version": null,
        "rules_applied": null,
        "rules_parameters": null,
        "why_not_slsqp": null,
        "why_not_slsqp_details": null,
        "message": "SLSQP converged",
        "portfolio_vol": 9.66,
        "vol_target": 12.0,
        "vol_tolerance": 3.0,
        "vol_diff": -2.34,
        "portfolio_score": 0.84,
        "n_assets": 10,
        "n_bonds": 3,
        "n_crypto": 1,
        "crypto_max_allowed": 5.0,
        "sectors": {
          "Crypto": 5.0,
          "Bonds": 24.0,
          "Diversified": 21.0,
          "Finance": 30.0,
          "Mat√©riaux": 15.0,
          "Sant√©": 5.0
        },
        "bucket_exposure": {
          "core": 46.0,
          "defensive": 24.0,
          "satellite": 30.0
        },
        "bucket_compliance": {
          "core": {
            "actual": 46.0,
            "target_min": 35.0,
            "target_max": 55.0,
            "in_range": true
          },
          "satellite": {
            "actual": 30.0,
            "target_min": 15.0,
            "target_max": 35.0,
            "in_range": true
          },
          "defensive": {
            "actual": 24.0,
            "target_min": 20.0,
            "target_max": 30.0,
            "in_range": true
          },
          "lottery": {
            "actual": 0.0,
            "target_min": 0.0,
            "target_max": 2.0,
            "in_range": true
          }
        },
        "corporate_group_exposure": {},
        "covariance_method": "structured+diag_shrink",
        "covariance_empirical_weight": 0.0,
        "covariance_kpis": {
          "condition_number": 5989.71,
          "condition_number_before_shrinkage": null,
          "shrinkage_applied": false,
          "shrinkage_intensity": 0.0,
          "eigen_clipped": 0,
          "eigen_clipped_pct": 0.0,
          "eigenvalue_min": 0.00011042466172063397,
          "eigenvalue_max": 0.6614120809960101,
          "eigenvalue_min_raw": 0.00011042466172063397,
          "matrix_size": 56,
          "is_well_conditioned": true,
          "thresholds": {
            "condition_number_warning": 10000.0,
            "eigen_clipped_pct_warning": 20.0
          }
        },
        "buffett_hard_filter_enabled": true,
        "buffett_min_score": 50.0,
        "constraint_report": {
          "profile_name": "Mod√©r√©",
          "constraints": [
            {
              "name": "volatility",
              "constraint_type": "target",
              "cap": 12.0,
              "observed": 9.66,
              "slack": 0.66,
              "binding": true,
              "status": "BINDING",
              "details": {
                "tolerance": 3.0,
                "range_min": 9.0,
                "range_max": 15.0,
                "diff_from_target": -2.34
              }
            },
            {
              "name": "bonds_min",
              "constraint_type": "min",
              "cap": 15.0,
              "observed": 24.0,
              "slack": 9.0,
              "binding": false,
              "status": "OK",
              "details": {
                "count": 3,
                "breakdown": [
                  {
                    "id": "iShares 3 Year International Treasury Bond ETF",
                    "name": "iShares 3 Year International T",
                    "weight": 8.0
                  },
                  {
                    "id": "VanEck J.P. Morgan EM Local Currency Bond ETF",
                    "name": "VanEck J.P. Morgan EM Local Cu",
                    "weight": 8.0
                  },
                  {
                    "id": "iShares J.P. Morgan EM Local Currency Bond ETF",
                    "name": "iShares J.P. Morgan EM Local C",
                    "weight": 8.0
                  }
                ]
              }
            },
            {
              "name": "crypto_max",
              "constraint_type": "max",
              "cap": 5.0,
              "observed": 5.0,
              "slack": 0.0,
              "binding": true,
              "status": "BINDING",
              "details": {
                "breakdown": [
                  {
                    "id": "BTC/USD",
                    "name": "BTC/USD",
                    "weight": 5.0
                  }
                ]
              }
            },
            {
              "name": "max_single_position",
              "constraint_type": "max",
              "cap": 15.0,
              "observed": 15.0,
              "slack": 0.0,
              "binding": true,
              "status": "BINDING",
              "details": {
                "largest_position": {
                  "id": "abrdn Physical Precious Metals Basket Shares ETF",
                  "name": "abrdn Physical Precious Metals Basket Sh",
                  "weight": 15.0
                },
                "positions_above_10pct": [
                  {
                    "id": "abrdn Physical Precious Metals Basket Shares ETF",
                    "weight": 15.0
                  },
                  {
                    "id": "EQ_641",
                    "weight": 15.0
                  },
                  {
                    "id": "EQ_537",
                    "weight": 15.0
                  },
                  {
                    "id": "EQ_562",
                    "weight": 15.0
                  }
                ]
              }
            },
            {
              "name": "max_sector",
              "constraint_type": "max",
              "cap": 30.0,
              "observed": 30.0,
              "slack": 0.0,
              "binding": true,
              "status": "BINDING",
              "details": {
                "most_concentrated": "Finance",
                "counts_in_max_sector": {
                  "Finance": 30.0,
                  "Mat√©riaux": 15.0,
                  "Sant√©": 5.0
                },
                "all_sectors": {
                  "Finance": 30.0,
                  "Bonds": 24.0,
                  "Diversified": 21.0,
                  "Mat√©riaux": 15.0,
                  "Crypto": 5.0,
                  "Sant√©": 5.0
                },
                "scope": "EQUITY_LIKE only (excludes Bonds)"
              }
            },
            {
              "name": "max_region",
              "constraint_type": "max",
              "cap": 50.0,
              "observed": 15.0,
              "slack": 35.0,
              "binding": false,
              "status": "OK",
              "details": {
                "most_concentrated": "Irlande",
                "counts_in_max_region": {
                  "Irlande": 15.0,
                  "Allemagne": 15.0,
                  "Royaume-Uni": 15.0,
                  "Etats-Unis": 5.0
                },
                "all_regions": {
                  "Global": 50.0,
                  "Irlande": 15.0,
                  "Allemagne": 15.0,
                  "Royaume-Uni": 15.0,
                  "Etats-Unis": 5.0
                },
                "scope": "EQUITY_LIKE + LEVERAGED only"
              }
            },
            {
              "name": "min_assets",
              "constraint_type": "min",
              "cap": 10,
              "observed": 10,
              "slack": 0,
              "binding": true,
              "status": "BINDING",
              "details": {}
            },
            {
              "name": "max_assets",
              "constraint_type": "max",
              "cap": 18,
              "observed": 10,
              "slack": 8,
              "binding": false,
              "status": "OK",
              "details": {}
            },
            {
              "name": "bucket_core",
              "constraint_type": "range",
              "cap": 55.0,
              "observed": 46.0,
              "slack": 9.0,
              "binding": false,
              "status": "OK",
              "details": {
                "range_min": 35.0,
                "range_max": 55.0,
                "slack_from_min": 11.0,
                "slack_from_max": 9.0,
                "outside_range": false,
                "is_indicator": true
              }
            },
            {
              "name": "bucket_satellite",
              "constraint_type": "range",
              "cap": 35.0,
              "observed": 30.0,
              "slack": 5.0,
              "binding": false,
              "status": "OK",
              "details": {
                "range_min": 15.0,
                "range_max": 35.0,
                "slack_from_min": 15.0,
                "slack_from_max": 5.0,
                "outside_range": false,
                "is_indicator": true
              }
            },
            {
              "name": "bucket_defensive",
              "constraint_type": "range",
              "cap": 30.0,
              "observed": 24.0,
              "slack": 4.0,
              "binding": false,
              "status": "OK",
              "details": {
                "range_min": 20.0,
                "range_max": 30.0,
                "slack_from_min": 4.0,
                "slack_from_max": 6.0,
                "outside_range": false,
                "is_indicator": true
              }
            },
            {
              "name": "bucket_lottery",
              "constraint_type": "range",
              "cap": 2.0,
              "observed": 0,
              "slack": 0.0,
              "binding": true,
              "status": "BINDING",
              "details": {
                "range_min": 0.0,
                "range_max": 2.0,
                "slack_from_min": 0.0,
                "slack_from_max": 2.0,
                "outside_range": false,
                "is_indicator": true
              }
            },
            {
              "name": "alternative_cap",
              "constraint_type": "max",
              "cap": 15.0,
              "observed": 0,
              "slack": 15.0,
              "binding": false,
              "status": "OK",
              "details": {
                "includes": [
                  "Derivative Income",
                  "Defined Outcome",
                  "Allocation funds"
                ]
              }
            }
          ],
          "summary": {
            "total": 13,
            "ok": 8,
            "binding": 5,
            "violated": 0,
            "critical": 0
          },
          "quality_score": 92.3,
          "recommendations": [
            "üü° BINDING: crypto_max at 5.0% (cap=5.0%) ‚Äî monitor closely",
            "üü° BINDING: max_single_position at 15.0% (cap=15.0%) ‚Äî monitor closely",
            "üü° BINDING: max_sector at 30.0% (cap=30.0%) ‚Äî monitor closely",
            "‚ö†Ô∏è 5 constraints are binding ‚Äî consider relaxing profile or reducing positions"
          ],
          "exposures": {
            "by_category": {
              "Crypto": 5.0,
              "Obligations": 24.0,
              "ETF": 21.0,
              "Actions": 50.0
            },
            "by_sector": {
              "Finance": 30.0,
              "Diversified": 21.0,
              "Mat√©riaux": 15.0,
              "Sant√©": 5.0
            },
            "by_region": {
              "Global": 50.0,
              "Irlande": 15.0,
              "Allemagne": 15.0,
              "Royaume-Uni": 15.0,
              "Etats-Unis": 5.0
            },
            "by_risk_bucket": {
              "crypto": 5.0,
              "bond_like": 24.0,
              "real_assets": 21.0,
              "equity_like": 50.0
            },
            "by_role": {
              "core": 46.0,
              "satellite": 30.0,
              "defensive": 24.0,
              "lottery": 0.0,
              "unknown": 0.0
            },
            "concentration": {
              "hhi": 1178.0,
              "hhi_interpretation": "diversified",
              "effective_n": 8.49,
              "n_positions": 10,
              "top_5_weight": 68.0,
              "top_10_weight": 100.0,
              "largest_position": 15.0,
              "smallest_position": 5.0,
              "thresholds": {
                "well_diversified": "HHI < 1000",
                "diversified": "HHI 1000-1500",
                "moderately_concentrated": "HHI 1500-2500",
                "highly_concentrated": "HHI > 2500"
              },
              "source": "exposures.py"
            }
          },
          "ticker_mapping": [
            {
              "id": "abrdn Physical Precious Metals Basket Shares ETF",
              "ticker": "GLTR",
              "isin": NaN,
              "name": "abrdn Physical Precious Metals Basket Shares ETF",
              "weight_pct": 15.0,
              "category": "ETF",
              "risk_bucket": "real_assets",
              "sector": "Diversified",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "EQ_641",
              "ticker": "A5G",
              "isin": null,
              "name": "AIB GROUP PLC",
              "weight_pct": 15.0,
              "category": "Actions",
              "risk_bucket": "equity_like",
              "sector": "Finance",
              "region": "Irlande",
              "exchange": null
            },
            {
              "id": "EQ_537",
              "ticker": "ALV",
              "isin": null,
              "name": "ALLIANZ",
              "weight_pct": 15.0,
              "category": "Actions",
              "risk_bucket": "equity_like",
              "sector": "Finance",
              "region": "Allemagne",
              "exchange": null
            },
            {
              "id": "EQ_562",
              "ticker": "RIO",
              "isin": null,
              "name": "RIO TINTO PLC",
              "weight_pct": 15.0,
              "category": "Actions",
              "risk_bucket": "equity_like",
              "sector": "Mat√©riaux",
              "region": "Royaume-Uni",
              "exchange": null
            },
            {
              "id": "iShares 3 Year International Treasury Bond ETF",
              "ticker": "ISHG",
              "isin": NaN,
              "name": "iShares 3 Year International Treasury Bond ETF",
              "weight_pct": 8.0,
              "category": "Obligations",
              "risk_bucket": "bond_like",
              "sector": "Bonds",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "VanEck J.P. Morgan EM Local Currency Bond ETF",
              "ticker": "EMLC",
              "isin": NaN,
              "name": "VanEck J.P. Morgan EM Local Currency Bond ETF",
              "weight_pct": 8.0,
              "category": "Obligations",
              "risk_bucket": "bond_like",
              "sector": "Bonds",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "iShares J.P. Morgan EM Local Currency Bond ETF",
              "ticker": "LEMB",
              "isin": NaN,
              "name": "iShares J.P. Morgan EM Local Currency Bond ETF",
              "weight_pct": 8.0,
              "category": "Obligations",
              "risk_bucket": "bond_like",
              "sector": "Bonds",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "iShares Silver Trust",
              "ticker": "SLV",
              "isin": NaN,
              "name": "iShares Silver Trust",
              "weight_pct": 6.0,
              "category": "ETF",
              "risk_bucket": "real_assets",
              "sector": "Diversified",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "BTC/USD",
              "ticker": "BTC/USD",
              "isin": null,
              "name": "BTC/USD",
              "weight_pct": 5.0,
              "category": "Crypto",
              "risk_bucket": "crypto",
              "sector": "Crypto",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "EQ_13",
              "ticker": "JNJ",
              "isin": null,
              "name": "JOHNSON & JOHNSON",
              "weight_pct": 5.0,
              "category": "Actions",
              "risk_bucket": "equity_like",
              "sector": "Sant√©",
              "region": "Etats-Unis",
              "exchange": null
            }
          ],
          "execution_summary": {
            "n_positions": 10,
            "n_exchanges": 0,
            "exchanges": [],
            "total_weight": 100.0,
            "missing_isin": 5,
            "missing_ticker": 0,
            "data_quality": {
              "isin_coverage": 50.0,
              "ticker_coverage": 100.0
            },
            "ready_for_execution": true
          }
        },
        "constraint_summary": {
          "total": 13,
          "ok": 8,
          "binding": 5,
          "violated": 0,
          "critical": 0
        },
        "constraint_quality_score": 92.3,
        "constraint_violations": [],
        "constraint_bindings": [
          {
            "name": "volatility",
            "constraint_type": "target",
            "cap": 12.0,
            "observed": 9.66,
            "slack": 0.66,
            "binding": true,
            "status": "BINDING",
            "details": {
              "tolerance": 3.0,
              "range_min": 9.0,
              "range_max": 15.0,
              "diff_from_target": -2.34
            }
          },
          {
            "name": "crypto_max",
            "constraint_type": "max",
            "cap": 5.0,
            "observed": 5.0,
            "slack": 0.0,
            "binding": true,
            "status": "BINDING",
            "details": {
              "breakdown": [
                {
                  "id": "BTC/USD",
                  "name": "BTC/USD",
                  "weight": 5.0
                }
              ]
            }
          },
          {
            "name": "max_single_position",
            "constraint_type": "max",
            "cap": 15.0,
            "observed": 15.0,
            "slack": 0.0,
            "binding": true,
            "status": "BINDING",
            "details": {
              "largest_position": {
                "id": "abrdn Physical Precious Metals Basket Shares ETF",
                "name": "abrdn Physical Precious Metals Basket Sh",
                "weight": 15.0
              },
              "positions_above_10pct": [
                {
                  "id": "abrdn Physical Precious Metals Basket Shares ETF",
                  "weight": 15.0
                },
                {
                  "id": "EQ_641",
                  "weight": 15.0
                },
                {
                  "id": "EQ_537",
                  "weight": 15.0
                },
                {
                  "id": "EQ_562",
                  "weight": 15.0
                }
              ]
            }
          },
          {
            "name": "max_sector",
            "constraint_type": "max",
            "cap": 30.0,
            "observed": 30.0,
            "slack": 0.0,
            "binding": true,
            "status": "BINDING",
            "details": {
              "most_concentrated": "Finance",
              "counts_in_max_sector": {
                "Finance": 30.0,
                "Mat√©riaux": 15.0,
                "Sant√©": 5.0
              },
              "all_sectors": {
                "Finance": 30.0,
                "Bonds": 24.0,
                "Diversified": 21.0,
                "Mat√©riaux": 15.0,
                "Crypto": 5.0,
                "Sant√©": 5.0
              },
              "scope": "EQUITY_LIKE only (excludes Bonds)"
            }
          },
          {
            "name": "min_assets",
            "constraint_type": "min",
            "cap": 10,
            "observed": 10,
            "slack": 0,
            "binding": true,
            "status": "BINDING",
            "details": {}
          },
          {
            "name": "bucket_lottery",
            "constraint_type": "range",
            "cap": 2.0,
            "observed": 0,
            "slack": 0.0,
            "binding": true,
            "status": "BINDING",
            "details": {
              "range_min": 0.0,
              "range_max": 2.0,
              "slack_from_min": 0.0,
              "slack_from_max": 2.0,
              "outside_range": false,
              "is_indicator": true
            }
          }
        ],
        "exposures": {
          "by_category": {
            "Crypto": 5.0,
            "Obligations": 24.0,
            "ETF": 21.0,
            "Actions": 50.0
          },
          "by_sector": {
            "Finance": 30.0,
            "Diversified": 21.0,
            "Mat√©riaux": 15.0,
            "Sant√©": 5.0
          },
          "by_region": {
            "Global": 50.0,
            "Irlande": 15.0,
            "Allemagne": 15.0,
            "Royaume-Uni": 15.0,
            "Etats-Unis": 5.0
          },
          "by_risk_bucket": {
            "crypto": 5.0,
            "bond_like": 24.0,
            "real_assets": 21.0,
            "equity_like": 50.0
          },
          "by_role": {
            "core": 46.0,
            "satellite": 30.0,
            "defensive": 24.0,
            "lottery": 0.0,
            "unknown": 0.0
          },
          "concentration": {
            "hhi": 1178.0,
            "hhi_interpretation": "diversified",
            "effective_n": 8.49,
            "n_positions": 10,
            "top_5_weight": 68.0,
            "top_10_weight": 100.0,
            "largest_position": 15.0,
            "smallest_position": 5.0,
            "thresholds": {
              "well_diversified": "HHI < 1000",
              "diversified": "HHI 1000-1500",
              "moderately_concentrated": "HHI 1500-2500",
              "highly_concentrated": "HHI > 2500"
            },
            "source": "exposures.py"
          }
        },
        "execution_summary": {
          "n_positions": 10,
          "n_exchanges": 0,
          "exchanges": [],
          "total_weight": 100.0,
          "missing_isin": 5,
          "missing_ticker": 0,
          "data_quality": {
            "isin_coverage": 50.0,
            "ticker_coverage": 100.0
          },
          "ready_for_execution": true
        },
        "_feasibility": {
          "feasible": true,
          "reason": null,
          "capacity": {
            "bonds": 9075.0,
            "n_candidates": 1719,
            "vol_range": "1%-150%"
          },
          "requirements": {
            "bonds_min": 15.0,
            "min_assets": 10,
            "vol_target": "12.0% ¬±3.0%"
          }
        },
        "llm_sanitizer": {
          "profile": "Mod√©r√©",
          "justifications_cleaned": 0,
          "total_hits": 0,
          "total_warnings": 0,
          "hit_labels": [],
          "used_fallback": false
        },
        "used_fallback_comment": false
      },
      "justifications": {
        "abrdn Physical Precious Metals Basket Shares ETF": "Ce fonds investit dans des m√©taux pr√©cieux, qui peuvent √™tre volatils en p√©riode d'incertitude √©conomique. [TH]",
        "AIB GROUP PLC": "Cette action est expos√©e aux fluctuations √©conomiques en Europe, ce qui peut affecter sa performance. [MC]",
        "ALLIANZ": "L'assureur est sensible aux variations des taux d'int√©r√™t et aux conditions √©conomiques globales. [MC]",
        "RIO TINTO PLC": "L'entreprise est expos√©e aux fluctuations des prix des mati√®res premi√®res, ce qui peut affecter sa rentabilit√©. [SEC]",
        "iShares 3 Year International Treasury Bond ETF": "Les obligations √† court terme peuvent offrir des rendements limit√©s en p√©riode de hausse des taux. [MC]",
        "VanEck J.P. Morgan EM Local Currency Bond ETF": "Les obligations en devises √©mergentes peuvent √™tre affect√©es par des fluctuations mon√©taires. [SEC]",
        "iShares J.P. Morgan EM Local Currency Bond ETF": "Les risques de change peuvent impacter la performance de ce fonds. [SEC]",
        "iShares Silver Trust": "L'argent peut √™tre volatile en raison des fluctuations des prix des mati√®res premi√®res. [TH]",
        "BTC/USD": "Les cryptomonnaies pr√©sentent une volatilit√© √©lev√©e, ce qui peut affecter la stabilit√© du portefeuille. [TH]",
        "JOHNSON & JOHNSON": "L'entreprise est expos√©e aux risques li√©s √† la recherche et d√©veloppement, pouvant impacter ses r√©sultats. [SEC]"
      },
      "comment": "Ce portefeuille mod√®le pr√©sente un √©quilibre entre des actifs √† rendement potentiellement √©lev√© et des investissements plus stables. Bien qu'il vise √† r√©duire la volatilit√©, les fluctuations des march√©s des mati√®res premi√®res et des actions peuvent toujours affecter sa performance. De plus, la pr√©sence de cryptomonnaies ajoute un niveau de risque suppl√©mentaire. Les investisseurs doivent √™tre conscients des risques associ√©s √† ces types d'actifs avant de prendre des d√©cisions. ‚ö†Ô∏è Performances calcul√©es sur 90 jours, hors frais de transaction et fiscalit√©. Sharpe ratio annualis√© sur p√©riode courte (non repr√©sentatif long terme). Les performances pass√©es ne pr√©jugent pas des performances futures.",
      "compliance": "‚ö†Ô∏è AVERTISSEMENT : Ce portefeuille est g√©n√©r√© √† titre informatif uniquement et ne constitue pas un conseil en investissement. Les performances pass√©es ne pr√©jugent pas des performances futures. Investir comporte des risques de perte en capital. Consultez un conseiller financier agr√©√© avant toute d√©cision d'investissement.\n\nüü° PROFIL MOD√âR√â : Ce portefeuille pr√©sente un niveau de risque mod√©r√©. Il convient aux investisseurs acceptant une certaine volatilit√© avec un horizon moyen terme (3-5 ans).\n\n‚Çø EXPOSITION CRYPTO (5.0%) : Les crypto-actifs sont des actifs hautement sp√©culatifs et volatils. Ils ne sont pas r√©gul√©s et pr√©sentent un risque de perte totale du capital investi.",
      "_compliance_audit": {
        "llm_sanitizer": {
          "sanitized": false,
          "removed_sentences": 0,
          "hits": [],
          "warnings": [],
          "removal_ratio": 0.0,
          "original_length": 480,
          "sanitized_length": 480
        },
        "timestamp": "2025-12-22T18:13:55.312478",
        "version": "v4.8.7",
        "fallback_used": false
      }
    },
    "Stable": {
      "allocation": {
        "JPMorgan Ultra-Short Municipal Income Fund": 6.26,
        "BondBloxx Bloomberg Six Month Target Duration US Treasury ETF": 0.66,
        "iShares 0-3 Month Treasury Bond ETF": 15.88,
        "iShares Short Treasury Bond ETF": 16.33,
        "US Treasury 3 Month Bill ETF": 0.66,
        "VANGUARD FTSE DEVELOPED MARKETS ETF": 13.61,
        "Vanguard Total International Stock Index Fund": 13.61,
        "Schwab International Equity ETF": 12.57,
        "EQ_537": 6.8,
        "EQ_12": 10.89,
        "EQ_15": 2.72
      },
      "diagnostics": {
        "converged": false,
        "optimization_mode": "fallback_heuristic",
        "fallback_reason": "Stable profile: strict constraints (vol 6%¬±3%, bonds_min 35%, DEFENSIVE 45-60%) mathematically incompatible with Markowitz optimization",
        "fallback_heuristic": true,
        "heuristic_name": "stable_rules_v1",
        "heuristic_version": "1.0.0",
        "rules_applied": [
          "bonds_min_35pct",
          "defensive_bucket_45_60pct",
          "vol_target_6pct_tolerance_3pct",
          "max_single_position_15pct",
          "max_single_bond_25pct",
          "min_assets_10",
          "max_assets_18",
          "low_vol_assets_preferred"
        ],
        "rules_parameters": {
          "bonds_min": 35.0,
          "vol_target": 6.0,
          "vol_tolerance": 3.0,
          "max_single_position": 15.0,
          "max_single_bond": 25.0,
          "min_assets": 10,
          "max_assets": 18,
          "defensive_min": 45.0,
          "defensive_max": 60.0
        },
        "why_not_slsqp": "vol_target_incompatible_with_markowitz",
        "why_not_slsqp_details": "Le profil Stable requiert vol_target=6% ¬± 3% et >35% obligations. Ces contraintes sont math√©matiquement incompatibles avec l'optimisation Markowitz mean-variance. L'univers d'actifs disponibles ne permet pas d'atteindre une volatilit√© si basse avec diversification suffisante. Fallback vers allocation heuristique (r√®gles pr√©d√©finies).",
        "message": "Fallback heuristique (contraintes strictes)",
        "portfolio_vol": 5.21,
        "vol_target": 6.0,
        "vol_tolerance": 3.0,
        "vol_diff": -0.79,
        "portfolio_score": 0.729,
        "n_assets": 11,
        "n_bonds": 5,
        "n_crypto": 0,
        "crypto_max_allowed": 0.0,
        "sectors": {
          "Bonds": 39.78999999999999,
          "Diversified": 39.79,
          "Finance": 20.41
        },
        "bucket_exposure": {
          "defensive": 39.78999999999999,
          "core": 46.589999999999996,
          "satellite": 13.610000000000001
        },
        "bucket_compliance": {
          "core": {
            "actual": 46.6,
            "target_min": 30.0,
            "target_max": 40.0,
            "in_range": false
          },
          "satellite": {
            "actual": 13.6,
            "target_min": 5.0,
            "target_max": 15.0,
            "in_range": true
          },
          "defensive": {
            "actual": 39.8,
            "target_min": 45.0,
            "target_max": 60.0,
            "in_range": false
          },
          "lottery": {
            "actual": 0.0,
            "target_min": 0.0,
            "target_max": 0.0,
            "in_range": true
          }
        },
        "corporate_group_exposure": {},
        "covariance_method": "structured+diag_shrink",
        "covariance_empirical_weight": 0.0,
        "covariance_kpis": {
          "condition_number": 4925.58,
          "condition_number_before_shrinkage": null,
          "shrinkage_applied": false,
          "shrinkage_intensity": 0.0,
          "eigen_clipped": 0,
          "eigen_clipped_pct": 0.0,
          "eigenvalue_min": 0.00011275765364518114,
          "eigenvalue_max": 0.555396796626826,
          "eigenvalue_min_raw": 0.00011275765364518114,
          "matrix_size": 58,
          "is_well_conditioned": true,
          "thresholds": {
            "condition_number_warning": 10000.0,
            "eigen_clipped_pct_warning": 20.0
          }
        },
        "buffett_hard_filter_enabled": true,
        "buffett_min_score": 50.0,
        "constraint_report": {
          "profile_name": "Stable",
          "constraints": [
            {
              "name": "volatility",
              "constraint_type": "target",
              "cap": 6.0,
              "observed": 5.21,
              "slack": 2.21,
              "binding": false,
              "status": "OK",
              "details": {
                "tolerance": 3.0,
                "range_min": 3.0,
                "range_max": 9.0,
                "diff_from_target": -0.79
              }
            },
            {
              "name": "bonds_min",
              "constraint_type": "min",
              "cap": 35.0,
              "observed": 39.79,
              "slack": 4.79,
              "binding": false,
              "status": "OK",
              "details": {
                "count": 5,
                "breakdown": [
                  {
                    "id": "JPMorgan Ultra-Short Municipal Income Fund",
                    "name": "JPMorgan Ultra-Short Municipal",
                    "weight": 6.26
                  },
                  {
                    "id": "BondBloxx Bloomberg Six Month Target Duration US Treasury ETF",
                    "name": "BondBloxx Bloomberg Six Month ",
                    "weight": 0.66
                  },
                  {
                    "id": "iShares 0-3 Month Treasury Bond ETF",
                    "name": "iShares 0-3 Month Treasury Bon",
                    "weight": 15.88
                  },
                  {
                    "id": "iShares Short Treasury Bond ETF",
                    "name": "iShares Short Treasury Bond ET",
                    "weight": 16.33
                  },
                  {
                    "id": "US Treasury 3 Month Bill ETF",
                    "name": "US Treasury 3 Month Bill ETF",
                    "weight": 0.66
                  }
                ]
              }
            },
            {
              "name": "max_single_position",
              "constraint_type": "max",
              "cap": 15.0,
              "observed": 16.33,
              "slack": -1.33,
              "binding": false,
              "status": "VIOLATED",
              "details": {
                "largest_position": {
                  "id": "iShares Short Treasury Bond ETF",
                  "name": "iShares Short Treasury Bond ETF",
                  "weight": 16.33
                },
                "positions_above_10pct": [
                  {
                    "id": "iShares 0-3 Month Treasury Bond ETF",
                    "weight": 15.88
                  },
                  {
                    "id": "iShares Short Treasury Bond ETF",
                    "weight": 16.33
                  },
                  {
                    "id": "VANGUARD FTSE DEVELOPED MARKETS ETF",
                    "weight": 13.61
                  },
                  {
                    "id": "Vanguard Total International Stock Index Fund",
                    "weight": 13.61
                  },
                  {
                    "id": "Schwab International Equity ETF",
                    "weight": 12.57
                  },
                  {
                    "id": "EQ_12",
                    "weight": 10.89
                  }
                ]
              }
            },
            {
              "name": "max_sector",
              "constraint_type": "max",
              "cap": 30.0,
              "observed": 39.79,
              "slack": -9.79,
              "binding": false,
              "status": "CRITICAL",
              "details": {
                "most_concentrated": "Diversified",
                "counts_in_max_sector": {
                  "Diversified": 39.79,
                  "Finance": 20.41
                },
                "all_sectors": {
                  "Diversified": 39.79,
                  "Bonds": 39.79,
                  "Finance": 20.41
                },
                "scope": "EQUITY_LIKE only (excludes Bonds)"
              }
            },
            {
              "name": "max_region",
              "constraint_type": "max",
              "cap": 50.0,
              "observed": 39.79,
              "slack": 10.21,
              "binding": false,
              "status": "OK",
              "details": {
                "most_concentrated": "Global",
                "counts_in_max_region": {
                  "Global": 39.79,
                  "Etats-Unis": 13.61,
                  "Allemagne": 6.8
                },
                "all_regions": {
                  "Global": 79.58,
                  "Etats-Unis": 13.61,
                  "Allemagne": 6.8
                },
                "scope": "EQUITY_LIKE + LEVERAGED only"
              }
            },
            {
              "name": "min_assets",
              "constraint_type": "min",
              "cap": 10,
              "observed": 11,
              "slack": 1,
              "binding": false,
              "status": "OK",
              "details": {}
            },
            {
              "name": "max_assets",
              "constraint_type": "max",
              "cap": 18,
              "observed": 11,
              "slack": 7,
              "binding": false,
              "status": "OK",
              "details": {}
            },
            {
              "name": "bucket_core",
              "constraint_type": "range",
              "cap": 40.0,
              "observed": 46.59,
              "slack": -6.59,
              "binding": false,
              "status": "OK",
              "details": {
                "range_min": 30.0,
                "range_max": 40.0,
                "slack_from_min": 16.59,
                "slack_from_max": -6.59,
                "outside_range": true,
                "is_indicator": true
              }
            },
            {
              "name": "bucket_satellite",
              "constraint_type": "range",
              "cap": 15.0,
              "observed": 13.61,
              "slack": 1.39,
              "binding": false,
              "status": "OK",
              "details": {
                "range_min": 5.0,
                "range_max": 15.0,
                "slack_from_min": 8.61,
                "slack_from_max": 1.39,
                "outside_range": false,
                "is_indicator": true
              }
            },
            {
              "name": "bucket_defensive",
              "constraint_type": "range",
              "cap": 60.0,
              "observed": 39.79,
              "slack": -5.21,
              "binding": false,
              "status": "OK",
              "details": {
                "range_min": 45.0,
                "range_max": 60.0,
                "slack_from_min": -5.21,
                "slack_from_max": 20.21,
                "outside_range": true,
                "is_indicator": true
              }
            },
            {
              "name": "bucket_lottery",
              "constraint_type": "range",
              "cap": 0.0,
              "observed": 0,
              "slack": 0.0,
              "binding": true,
              "status": "BINDING",
              "details": {
                "range_min": 0.0,
                "range_max": 0.0,
                "slack_from_min": 0.0,
                "slack_from_max": 0.0,
                "outside_range": false,
                "is_indicator": true
              }
            },
            {
              "name": "alternative_cap",
              "constraint_type": "max",
              "cap": 5.0,
              "observed": 0,
              "slack": 5.0,
              "binding": false,
              "status": "OK",
              "details": {
                "includes": [
                  "Derivative Income",
                  "Defined Outcome",
                  "Allocation funds"
                ]
              }
            }
          ],
          "summary": {
            "total": 12,
            "ok": 10,
            "binding": 0,
            "violated": 1,
            "critical": 1
          },
          "quality_score": 81.7,
          "recommendations": [
            "üü† VIOLATED: max_single_position exceeded by 1.3% ‚Äî reduce exposure",
            "üî¥ CRITICAL: max_sector violated by 9.8% ‚Äî immediate action required"
          ],
          "exposures": {
            "by_category": {
              "Obligations": 39.79,
              "ETF": 39.79,
              "Actions": 20.41
            },
            "by_sector": {
              "Diversified": 39.79,
              "Finance": 20.41
            },
            "by_region": {
              "Global": 79.58,
              "Etats-Unis": 13.61,
              "Allemagne": 6.8
            },
            "by_risk_bucket": {
              "bond_like": 39.79,
              "equity_like": 60.2
            },
            "by_role": {
              "core": 46.59,
              "satellite": 13.61,
              "defensive": 39.79,
              "lottery": 0.0,
              "unknown": 0.0
            },
            "concentration": {
              "hhi": 1260.0,
              "hhi_interpretation": "diversified",
              "effective_n": 7.94,
              "n_positions": 11,
              "top_5_weight": 72.0,
              "top_10_weight": 99.33,
              "largest_position": 16.33,
              "smallest_position": 0.66,
              "thresholds": {
                "well_diversified": "HHI < 1000",
                "diversified": "HHI 1000-1500",
                "moderately_concentrated": "HHI 1500-2500",
                "highly_concentrated": "HHI > 2500"
              },
              "source": "exposures.py"
            }
          },
          "ticker_mapping": [
            {
              "id": "iShares Short Treasury Bond ETF",
              "ticker": "SHV",
              "isin": NaN,
              "name": "iShares Short Treasury Bond ETF",
              "weight_pct": 16.33,
              "category": "Obligations",
              "risk_bucket": "bond_like",
              "sector": "Bonds",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "iShares 0-3 Month Treasury Bond ETF",
              "ticker": "SGOV",
              "isin": NaN,
              "name": "iShares 0-3 Month Treasury Bond ETF",
              "weight_pct": 15.88,
              "category": "Obligations",
              "risk_bucket": "bond_like",
              "sector": "Bonds",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "VANGUARD FTSE DEVELOPED MARKETS ETF",
              "ticker": "VEA",
              "isin": NaN,
              "name": "VANGUARD FTSE DEVELOPED MARKETS ETF",
              "weight_pct": 13.61,
              "category": "ETF",
              "risk_bucket": "equity_like",
              "sector": "Diversified",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "Vanguard Total International Stock Index Fund",
              "ticker": "VXUS",
              "isin": NaN,
              "name": "Vanguard Total International Stock Index Fund",
              "weight_pct": 13.61,
              "category": "ETF",
              "risk_bucket": "equity_like",
              "sector": "Diversified",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "Schwab International Equity ETF",
              "ticker": "SCHF",
              "isin": NaN,
              "name": "Schwab International Equity ETF",
              "weight_pct": 12.57,
              "category": "ETF",
              "risk_bucket": "equity_like",
              "sector": "Diversified",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "EQ_12",
              "ticker": "V",
              "isin": null,
              "name": "VISA INC CLASS A",
              "weight_pct": 10.89,
              "category": "Actions",
              "risk_bucket": "equity_like",
              "sector": "Finance",
              "region": "Etats-Unis",
              "exchange": null
            },
            {
              "id": "EQ_537",
              "ticker": "ALV",
              "isin": null,
              "name": "ALLIANZ",
              "weight_pct": 6.8,
              "category": "Actions",
              "risk_bucket": "equity_like",
              "sector": "Finance",
              "region": "Allemagne",
              "exchange": null
            },
            {
              "id": "JPMorgan Ultra-Short Municipal Income Fund",
              "ticker": "JMST",
              "isin": NaN,
              "name": "JPMorgan Ultra-Short Municipal Income Fund",
              "weight_pct": 6.26,
              "category": "Obligations",
              "risk_bucket": "bond_like",
              "sector": "Bonds",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "EQ_15",
              "ticker": "MA",
              "isin": null,
              "name": "MASTERCARD INC CLASS A",
              "weight_pct": 2.72,
              "category": "Actions",
              "risk_bucket": "equity_like",
              "sector": "Finance",
              "region": "Etats-Unis",
              "exchange": null
            },
            {
              "id": "BondBloxx Bloomberg Six Month Target Duration US Treasury ETF",
              "ticker": "XHLF",
              "isin": NaN,
              "name": "BondBloxx Bloomberg Six Month Target Duration US Treasury ET",
              "weight_pct": 0.66,
              "category": "Obligations",
              "risk_bucket": "bond_like",
              "sector": "Bonds",
              "region": "Global",
              "exchange": null
            },
            {
              "id": "US Treasury 3 Month Bill ETF",
              "ticker": "TBIL",
              "isin": NaN,
              "name": "US Treasury 3 Month Bill ETF",
              "weight_pct": 0.66,
              "category": "Obligations",
              "risk_bucket": "bond_like",
              "sector": "Bonds",
              "region": "Global",
              "exchange": null
            }
          ],
          "execution_summary": {
            "n_positions": 11,
            "n_exchanges": 0,
            "exchanges": [],
            "total_weight": 99.99,
            "missing_isin": 3,
            "missing_ticker": 0,
            "data_quality": {
              "isin_coverage": 72.7,
              "ticker_coverage": 100.0
            },
            "ready_for_execution": true
          }
        },
        "constraint_summary": {
          "total": 12,
          "ok": 10,
          "binding": 0,
          "violated": 1,
          "critical": 1
        },
        "constraint_quality_score": 81.7,
        "constraint_violations": [
          {
            "name": "max_single_position",
            "constraint_type": "max",
            "cap": 15.0,
            "observed": 16.33,
            "slack": -1.33,
            "binding": false,
            "status": "VIOLATED",
            "details": {
              "largest_position": {
                "id": "iShares Short Treasury Bond ETF",
                "name": "iShares Short Treasury Bond ETF",
                "weight": 16.33
              },
              "positions_above_10pct": [
                {
                  "id": "iShares 0-3 Month Treasury Bond ETF",
                  "weight": 15.88
                },
                {
                  "id": "iShares Short Treasury Bond ETF",
                  "weight": 16.33
                },
                {
                  "id": "VANGUARD FTSE DEVELOPED MARKETS ETF",
                  "weight": 13.61
                },
                {
                  "id": "Vanguard Total International Stock Index Fund",
                  "weight": 13.61
                },
                {
                  "id": "Schwab International Equity ETF",
                  "weight": 12.57
                },
                {
                  "id": "EQ_12",
                  "weight": 10.89
                }
              ]
            }
          },
          {
            "name": "max_sector",
            "constraint_type": "max",
            "cap": 30.0,
            "observed": 39.79,
            "slack": -9.79,
            "binding": false,
            "status": "CRITICAL",
            "details": {
              "most_concentrated": "Diversified",
              "counts_in_max_sector": {
                "Diversified": 39.79,
                "Finance": 20.41
              },
              "all_sectors": {
                "Diversified": 39.79,
                "Bonds": 39.79,
                "Finance": 20.41
              },
              "scope": "EQUITY_LIKE only (excludes Bonds)"
            }
          }
        ],
        "constraint_bindings": [
          {
            "name": "bucket_lottery",
            "constraint_type": "range",
            "cap": 0.0,
            "observed": 0,
            "slack": 0.0,
            "binding": true,
            "status": "BINDING",
            "details": {
              "range_min": 0.0,
              "range_max": 0.0,
              "slack_from_min": 0.0,
              "slack_from_max": 0.0,
              "outside_range": false,
              "is_indicator": true
            }
          }
        ],
        "exposures": {
          "by_category": {
            "Obligations": 39.79,
            "ETF": 39.79,
            "Actions": 20.41
          },
          "by_sector": {
            "Diversified": 39.79,
            "Finance": 20.41
          },
          "by_region": {
            "Global": 79.58,
            "Etats-Unis": 13.61,
            "Allemagne": 6.8
          },
          "by_risk_bucket": {
            "bond_like": 39.79,
            "equity_like": 60.2
          },
          "by_role": {
            "core": 46.59,
            "satellite": 13.61,
            "defensive": 39.79,
            "lottery": 0.0,
            "unknown": 0.0
          },
          "concentration": {
            "hhi": 1260.0,
            "hhi_interpretation": "diversified",
            "effective_n": 7.94,
            "n_positions": 11,
            "top_5_weight": 72.0,
            "top_10_weight": 99.33,
            "largest_position": 16.33,
            "smallest_position": 0.66,
            "thresholds": {
              "well_diversified": "HHI < 1000",
              "diversified": "HHI 1000-1500",
              "moderately_concentrated": "HHI 1500-2500",
              "highly_concentrated": "HHI > 2500"
            },
            "source": "exposures.py"
          }
        },
        "execution_summary": {
          "n_positions": 11,
          "n_exchanges": 0,
          "exchanges": [],
          "total_weight": 99.99,
          "missing_isin": 3,
          "missing_ticker": 0,
          "data_quality": {
            "isin_coverage": 72.7,
            "ticker_coverage": 100.0
          },
          "ready_for_execution": true
        },
        "_feasibility": {
          "feasible": true,
          "reason": null,
          "capacity": {
            "bonds": 9075.0,
            "n_candidates": 1719,
            "vol_range": "1%-150%"
          },
          "requirements": {
            "bonds_min": 35.0,
            "min_assets": 10,
            "vol_target": "6.0% ¬±3.0%"
          }
        },
        "llm_sanitizer": {
          "profile": "Stable",
          "justifications_cleaned": 0,
          "total_hits": 0,
          "total_warnings": 0,
          "hit_labels": [],
          "used_fallback": false
        },
        "used_fallback_comment": false
      },
      "justifications": {
        "iShares Short Treasury Bond ETF": "Ces obligations √† court terme sont g√©n√©ralement moins volatiles, mais offrent des rendements limit√©s. [MC]",
        "iShares 0-3 Month Treasury Bond ETF": "Les obligations √† court terme peuvent offrir des rendements limit√©s en p√©riode de hausse des taux. [MC]",
        "VANGUARD FTSE DEVELOPED MARKETS ETF": "Ce fonds investit dans des march√©s d√©velopp√©s, qui peuvent offrir une stabilit√© relative. [MC]",
        "Vanguard Total International Stock Index Fund": "L'exposition internationale peut r√©duire le risque li√© √† un march√© unique, mais expose √©galement √† des fluctuations mon√©taires. [SEC]",
        "Schwab International Equity ETF": "Les actions internationales peuvent √™tre affect√©es par des risques g√©opolitiques et √©conomiques. [MC]",
        "VISA INC CLASS A": "L'entreprise est sensible aux variations √©conomiques et √† la concurrence dans le secteur des paiements. [SEC]",
        "ALLIANZ": "L'assureur est sensible aux variations des taux d'int√©r√™t et aux conditions √©conomiques globales. [MC]",
        "JPMorgan Ultra-Short Municipal Income Fund": "Les obligations municipales √† court terme peuvent offrir des rendements limit√©s en p√©riode de hausse des taux. [MC]",
        "MASTERCARD INC CLASS A": "L'entreprise est expos√©e aux risques li√©s √† la concurrence et aux variations √©conomiques. [SEC]",
        "BondBloxx Bloomberg Six Month Target Duration US Treasury ETF": "Ces obligations √† court terme sont g√©n√©ralement moins volatiles, mais offrent des rendements limit√©s. [MC]",
        "US Treasury 3 Month Bill ETF": "Les obligations √† court terme peuvent offrir des rendements limit√©s en p√©riode de hausse des taux. [MC]"
      },
      "comment": "Ce portefeuille mod√®le pr√©sente une approche avec un profil d√©fensif, visant √† minimiser la volatilit√© tout en offrant une possiblee exposition aux march√©s. La s√©lection d'obligations √† court terme et d'ETF diversifi√©s contribue √† une stabilit√© relative. Cependant, les rendements peuvent √™tre limit√©s, surtout en p√©riode de hausse des taux d'int√©r√™t. Les investisseurs doivent √™tre conscients des risques associ√©s √† la fluctuation des taux et des march√©s internationaux. ‚ö†Ô∏è Performances calcul√©es sur 90 jours, hors frais de transaction et fiscalit√©. Sharpe ratio annualis√© sur p√©riode courte (non repr√©sentatif long terme). Les performances pass√©es ne pr√©jugent pas des performances futures.",
      "compliance": "‚ö†Ô∏è AVERTISSEMENT : Ce portefeuille est g√©n√©r√© √† titre informatif uniquement et ne constitue pas un conseil en investissement. Les performances pass√©es ne pr√©jugent pas des performances futures. Investir comporte des risques de perte en capital. Consultez un conseiller financier agr√©√© avant toute d√©cision d'investissement.\n\nüü¢ PROFIL STABLE : Ce portefeuille vise une volatilit√© r√©duite. Il convient aux investisseurs prudents avec un horizon court √† moyen terme.",
      "_compliance_audit": {
        "llm_sanitizer": {
          "sanitized": false,
          "removed_sentences": 0,
          "hits": [],
          "warnings": [],
          "removal_ratio": 0.0,
          "original_length": 471,
          "sanitized_length": 471
        },
        "timestamp": "2025-12-22T18:13:55.312992",
        "version": "v4.8.7",
        "fallback_used": false
      }
    }
  }
}