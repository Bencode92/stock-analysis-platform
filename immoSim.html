<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ImmoSim - Simulateur d'Investissement Immobilier</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
    
    <!-- üéØ CSS CONSOLID√â - ARCHITECTURE PROPRE -->
    <link rel="stylesheet" href="css/immo-enhanced.css">
    <link rel="stylesheet" href="css/regimes-fiscaux.css">
    
    <!-- Chart.js pour les graphiques -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
</head>
<body>
    <!-- Sidebar de navigation verticale -->
    <aside class="sidebar">
        <div class="sidebar-logo">TP</div>
        <nav class="sidebar-nav">
            <a href="actualites.html" class="nav-item" title="Actualit√©s">
                <i class="fas fa-newspaper"></i>
            </a>
            <a href="portefeuille.html" class="nav-item" title="Portefeuilles">
                <i class="fas fa-chart-pie"></i>
            </a>
            <a href="dashboard.html" class="nav-item" title="Tableau de bord">
                <i class="fas fa-tachometer-alt"></i>
            </a>
            <a href="marches.html" class="nav-item" title="March√©s">
                <i class="fas fa-chart-line"></i>
            </a>
            <a href="secteurs.html" class="nav-item" title="Secteurs">
                <i class="fas fa-industry"></i>
            </a>
            <a href="liste.html" class="nav-item" title="Listes">
                <i class="fas fa-list"></i>
            </a>
            <a href="etf.html" class="nav-item" title="ETF">
                <i class="fas fa-funnel-dollar"></i>
            </a>
            <a href="crypto.html" class="nav-item" title="Crypto">
                <i class="fab fa-bitcoin"></i>
            </a>
            <a href="simulation.html" class="nav-item" title="Simulation">
                <i class="fas fa-calculator"></i>
            </a>
            <a href="guide-placements.html" class="nav-item" title="Guide Placements">
                <i class="fas fa-book"></i>
            </a>
            <a href="types-entreprise.html" class="nav-item" title="Types d'Entreprise">
                <i class="fas fa-building"></i>
            </a>
            <a href="immoSim.html" class="nav-item active" title="Simulateur Immobilier">
                <i class="fas fa-home"></i>
            </a>
            <a href="parametres.html" class="nav-item" title="Param√®tres">
                <i class="fas fa-cog"></i>
            </a>
        </nav>
    </aside>

    <!-- Header principal -->
    <header class="main-header">
        <div class="header-left">
            <div class="logo-container">
                <div class="pulse-dot"></div>
                <a href="index.html">TRADEPULSE</a>
            </div>
            <nav class="main-nav">
                <a href="actualites.html">Actualit√©s</a>
                <a href="portefeuille.html?type=modere">Portefeuilles</a>
                <a href="dashboard.html">Tableau de bord</a>
                <a href="marches.html">March√©s</a>
                <a href="secteurs.html">Secteurs</a>
                <a href="liste.html">Listes</a>
                <a href="etf.html">ETF</a>
                <a href="crypto.html">Crypto</a>
                <a href="simulation.html">Simulation</a>
                <a href="guide-placements.html">Guide Placements</a>
                <a href="types-entreprise.html">Types d'Entreprise</a>
                <a href="immoSim.html" class="active">Simulateur Immobilier</a>
            </nav>
        </div>
        <div class="header-right">
            <div class="market-status">
                <div class="market-indicator green"></div>
                <span>March√© ouvert</span>
                <span class="market-time" id="marketTime">15:52:47</span>
            </div>
            <a href="recherche.html" class="search-button ripple">
                <i class="fas fa-search"></i>
                <span>Ma question</span>
            </a>
        </div>
    </header>

    <div class="container">
        <div class="page-title">
            <h1>Simulateur d'Investissement Immobilier</h1>
            <div class="subtitle">Comparez achat classique et vente aux ench√®res avec vos donn√©es r√©elles</div>
        </div>

        <!-- Banner explicative du mode 100% march√© -->
        <div class="mode-info-banner fade-in">
            <div class="mode-info-icon">
                <i class="fas fa-database"></i>
            </div>
            <div class="mode-info-content">
                <h3>Mode 100% march√© avec base de donn√©es r√©elle</h3>
                <p>Ce simulateur utilise une base de donn√©es de plus de 1000 villes fran√ßaises avec prix r√©els au m¬≤ et loyers. Recherchez votre ville pour obtenir des estimations pr√©cises ou saisissez vos propres donn√©es.</p>
            </div>
        </div>
        
        <!-- Nouvelle banni√®re d'information sur les travaux -->
        <div class="info-message mb-4 fade-in">
            <div class="text-lg text-green-400 mr-3">
                <i class="fas fa-lightbulb"></i>
            </div>
            <div>
                <h4 class="font-medium mb-1">Comment sont calcul√©s les travaux?</h4>
                <p class="text-sm opacity-90">Par d√©faut, les travaux sont estim√©s √† 0,5% du prix d'achat. Vous pouvez changer cette valeur dans les param√®tres avanc√©s, o√π vous avez le choix entre un montant fixe au m¬≤ ou un pourcentage du prix d'achat.</p>
            </div>
        </div>
        
        <!-- Conteneur pour les messages de r√©sultat -->
        <div id="simulation-status" style="display: none;"></div>
        
        <!-- Inputs de base -->
        <div class="card backdrop-blur-md bg-opacity-20 border border-blue-400/10 shadow-lg hover:shadow-blue-500/5 transition-all">
            <div class="card-header">
                <div class="card-icon">
                    <i class="fas fa-money-bill-wave"></i>
                </div>
                <h2 class="card-title">Param√®tres de base</h2>
            </div>
            
            <div class="grid grid-2">
                <!-- NOUVEAU: Recherche de ville -->
                <div class="form-group" style="grid-column: 1 / -1;">
                    <label class="form-label" for="ville-search">
                        Rechercher une ville
                        <i class="fas fa-info-circle info-tooltip" title="Tapez le nom de votre ville pour auto-remplir les prix et loyers"></i>
                    </label>
                    <div class="search-container">
                        <input type="text" id="ville-search" class="form-input" placeholder="Ex: Lyon, Paris, Marseille..." autocomplete="off">
                        <div id="ville-suggestions" class="ville-suggestions" style="display: none;"></div>
                    </div>
                    
                    <!-- Informations ville s√©lectionn√©e -->
                    <div id="ville-selected-info" class="ville-info-selected" style="display: none;">
                        <h4 style="margin: 0 0 0.5rem 0; color: var(--primary-color);">
                            <i class="fas fa-map-marker-alt"></i> <span id="ville-nom"></span>
                        </h4>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <span>D√©partement: <strong id="ville-dept"></strong></span>
                            <span style="color: var(--primary-color);">Types disponibles: <strong id="ville-types"></strong></span>
                        </div>
                        
                        <!-- S√©lecteur de type de logement -->
                        <div class="form-group" style="margin-bottom: 0;">
                            <label class="form-label">Type de logement</label>
                            <div id="piece-selector" class="piece-selector">
                                <!-- Les boutons seront g√©n√©r√©s dynamiquement -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Option "Autre ville" -->
                    <div style="margin-top: 1rem;">
                        <label class="flex items-center cursor-pointer">
                            <input type="checkbox" id="autre-ville-checkbox" style="margin-right: 0.5rem;">
                            <span>Ma ville n'est pas dans la liste (saisie manuelle)</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="apport">
                        Apport disponible
                        <i class="fas fa-info-circle info-tooltip" title="Somme que vous pouvez investir initialement"></i>
                    </label>
                    <div class="form-input-wrapper">
                        <input type="number" id="apport" class="form-input" placeholder="20000" value="20000">
                        <span class="form-addon-text">‚Ç¨</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="prix-m2-marche">
                        Prix au m¬≤ du march√©
                        <i class="fas fa-info-circle info-tooltip" title="Prix moyen au m√®tre carr√© dans le secteur"></i>
                    </label>
                    <div class="form-input-wrapper">
                        <input type="number" id="prix-m2-marche" class="form-input highlight-field" value="2000" step="50">
                        <span class="form-addon-text">‚Ç¨/m¬≤</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="loyer-m2">
                        Loyer au m¬≤ du march√©
                        <i class="fas fa-info-circle info-tooltip" title="Loyer mensuel par m√®tre carr√© dans le secteur"></i>
                    </label>
                    <div class="form-input-wrapper">
                        <input type="number" id="loyer-m2" class="form-input highlight-field" value="12" step="0.1">
                        <span class="form-addon-text">‚Ç¨/m¬≤/mois</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="taux">
                        Taux d'emprunt
                        <i class="fas fa-info-circle info-tooltip" title="Taux d'int√©r√™t annuel du cr√©dit immobilier"></i>
                    </label>
                    <div class="form-input-wrapper">
                        <input type="number" id="taux" class="form-input" placeholder="3.5" value="3.5" step="0.1">
                        <span class="form-addon-text">%</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="duree">
                        Dur√©e du pr√™t
                        <i class="fas fa-info-circle info-tooltip" title="Dur√©e du pr√™t en ann√©es"></i>
                    </label>
                    <div class="form-input-wrapper">
                        <input type="number" id="duree" class="form-input" placeholder="20" value="20">
                        <span class="form-addon-text">ans</span>
                    </div>
                </div>
                
                <!-- Champs cach√©s pour compatibilit√© -->
                <input type="hidden" id="surface" value="50">
                <input type="hidden" id="montant-emprunt-max" value="150000">
            </div>
            
            <!-- Mode de calcul (version am√©lior√©e) -->
            <div class="form-group">
                <label class="form-label">Mode de calcul</label>
                <div class="calculation-mode-container">
                    <label class="mode-option">
                        <input type="radio" name="calculation-mode" id="mode-loyer-mensualite" value="loyer-mensualite" checked>
                        <div class="mode-card">
                            <div class="mode-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="mode-content">
                                <h4>Loyer ‚â• Mensualit√©</h4>
                                <p>Le loyer net couvre la mensualit√© du pr√™t</p>
                            </div>
                        </div>
                    </label>
                    
                    <label class="mode-option">
                        <input type="radio" name="calculation-mode" id="mode-cashflow-positif" value="cashflow-positif">
                        <div class="mode-card">
                            <div class="mode-icon">
                                <i class="fas fa-coins"></i>
                            </div>
                            <div class="mode-content">
                                <h4>Cash-flow positif</h4>
                                <p>Toutes charges comprises (plus strict)</p>
                            </div>
                        </div>
                    </label>
                </div>
                <div class="text-sm text-blue-300 mt-2 pl-2">
                    <i class="fas fa-info-circle mr-1"></i>
                    Choisissez le crit√®re qui d√©terminera la surface maximale que vous pourrez acqu√©rir.
                </div>
            </div>
            
            <div class="flex justify-center mt-4">
                <button id="btn-simulate" class="btn btn-primary btn-simulate">
                    <i class="fas fa-calculator"></i> Simuler
                </button>
                <button id="btn-advanced-toggle" class="btn btn-outline ml-3">
                    <i class="fas fa-sliders-h"></i> Param√®tres avanc√©s
                </button>
            </div>
        </div>
        
        <!-- Param√®tres avanc√©s (masqu√©s par d√©faut) -->
        <div id="advanced-params" class="hidden fade-in">
            <div class="card backdrop-blur-md bg-opacity-20 border border-blue-400/10 shadow-lg transition-all">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-cogs"></i>
                    </div>
                    <h2 class="card-title">Param√®tres avanc√©s</h2>
                </div>
                
                <div class="tabs">
                    <div class="tab active" data-tab="params-communs">Communs</div>
                    <div class="tab" data-tab="params-classique">Achat Classique</div>
                    <div class="tab" data-tab="params-encheres">Vente aux Ench√®res</div>
                </div>
                
                <!-- Param√®tres communs -->
                <div class="tab-content active" id="params-communs">
                    <div class="grid grid-2">
                        <div class="form-group">
                            <label class="form-label" for="frais-bancaires-dossier">
                                Frais bancaires - dossier
                                <i class="fas fa-info-circle info-tooltip" title="Frais de dossier factur√©s par la banque"></i>
                            </label>
                            <div class="form-input-wrapper">
                                <input type="number" id="frais-bancaires-dossier" class="form-input" value="2000">
                                <span class="form-addon-text">‚Ç¨</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="frais-bancaires-compte">
                                Frais bancaires - tenue de compte
                                <i class="fas fa-info-circle info-tooltip" title="Frais pour la tenue de compte pendant la dur√©e du pr√™t"></i>
                            </label>
                            <div class="form-input-wrapper">
                                <input type="number" id="frais-bancaires-compte" class="form-input" value="710">
                                <span class="form-addon-text">‚Ç¨</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="frais-garantie">
                                Frais de garantie (caution/PPD)
                                <i class="fas fa-info-circle info-tooltip" title="Garantie du pr√™t, g√©n√©ralement un pourcentage du capital emprunt√©"></i>
                            </label>
                            <div class="form-input-wrapper">
                                <input type="number" id="frais-garantie" class="form-input" value="1.3709" step="0.0001">
                                <span class="form-addon-text">%</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="pourcent-apport">
                                Apport minimum exig√©
                                <i class="fas fa-info-circle info-tooltip" title="Pourcentage d'apport g√©n√©ralement exig√© par les banques"></i>
                            </label>
                            <div class="form-input-wrapper">
                                <input type="number" id="pourcent-apport" class="form-input" value="10" min="5" max="30" step="1">
                                <span class="form-addon-text">%</span>
                            </div>
                            <span class="form-help">Ratio g√©n√©ralement exig√© par les banques (10-15%)</span>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="taxe-fonciere">
                                Taxe fonci√®re
                                <i class="fas fa-info-circle info-tooltip" title="Imp√¥t local annuel en pourcentage de la valeur"></i>
                            </label>
                            <div class="form-input-wrapper">
                                <input type="number" id="taxe-fonciere" class="form-input" value="1" step="0.1">
                                <span class="form-addon-text">%</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="vacance-locative">
                                Vacance locative
                                <i class="fas fa-info-circle info-tooltip" title="Provision pour les p√©riodes sans locataire"></i>
                            </label>
                            <div class="form-input-wrapper">
                                <input type="number" id="vacance-locative" class="form-input" value="5" step="1">
                                <span class="form-addon-text">%</span>
                            </div>
                        </div>
                        
                        <!-- Nouveau mode de calcul des travaux -->
                        <div class="form-group">
                            <label class="form-label">
                                Mode de calcul des travaux
                                <i class="fas fa-info-circle info-tooltip" title="Choisissez comment calculer les travaux"></i>
                            </label>
                            <div class="flex items-center">
                                <label class="inline-flex items-center mr-4">
                                    <input type="radio" name="travaux-mode" id="travaux-mode-percentage" value="percentage" checked class="mr-2">
                                    <span>0,5% du prix d'achat</span>
                                </label>
                                <label class="inline-flex items-center">
                                    <input type="radio" name="travaux-mode" id="travaux-mode-m2" value="m2" class="mr-2">
                                    <span>Montant fixe au m¬≤</span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="travaux-m2">
                                Travaux au m¬≤
                                <i class="fas fa-info-circle info-tooltip" title="Montant des travaux par m¬≤"></i>
                            </label>
                            <div class="form-input-wrapper">
                                <input type="number" id="travaux-m2" class="form-input" value="400" step="10">
                                <span class="form-addon-text">‚Ç¨/m¬≤</span>
                            </div>
                            <span class="form-help">Utilis√© uniquement si "Montant fixe au m¬≤" est s√©lectionn√©</span>
                        </div>
                    </div>
                </div>
                
                <!-- Param√®tres achat classique -->
                <div class="tab-content" id="params-classique">
                    <div class="form-group">
                        <label class="form-label">Frais de notaire d√©taill√©s</label>
                    </div>
                    
                    <div class="grid grid-3">
                        <div class="form-group">
                            <label class="form-label" for="publicite-fonciere">Publicit√© fonci√®re</label>
                            <div class="form-input-wrapper">
                                <input type="number" id="publicite-fonciere" class="form-input" value="0.72" step="0.01">
                                <span class="form-addon-text">%</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="droits-mutation">Droits de mutation</label>
                            <div class="form-input-wrapper">
                                <input type="number" id="droits-mutation" class="form-input" value="5.81" step="0.01">
                                <span class="form-addon-text">%</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="securite-immobiliere">S√©curit√© immobili√®re</label>
                            <div class="form-input-wrapper">
                                <input type="number" id="securite-immobiliere" class="form-input" value="0.10" step="0.01">
                                <span class="form-addon-text">%</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="emoluments-vente">√âmoluments / frais de vente</label>
                            <div class="form-input-wrapper">
                                <input type="number" id="emoluments-vente" class="form-input" value="1.12" step="0.01">
                                <span class="form-addon-text">%</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="formalites">Formalit√©s</label>
                            <div class="form-input-wrapper">
                                <input type="number" id="formalites" class="form-input" value="0.28" step="0.01">
                                <span class="form-addon-text">%</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="debours">D√©bours</label>
                            <div class="form-input-wrapper">
                                <input type="number" id="debours" class="form-input" value="0.13" step="0.01">
                                <span class="form-addon-text">%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="commission-immo">
                            Commission immobili√®re
                            <i class="fas fa-info-circle info-tooltip" title="Commission de l'agence immobili√®re, g√©n√©ralement 5-6% du prix"></i>
                        </label>
                        <div class="form-input-wrapper">
                            <input type="number" id="commission-immo" class="form-input" value="5" step="0.1">
                            <span class="form-addon-text">%</span>
                        </div>
                    </div>
                </div>
                
                <!-- Param√®tres vente aux ench√®res -->
                <div class="tab-content" id="params-encheres">
                    <div class="grid grid-2">
                        <div class="form-group">
                            <label class="form-label" for="droits-enregistrement">Droits d'enregistrement</label>
                            <div class="form-input-wrapper">
                                <input type="number" id="droits-enregistrement" class="form-input" value="5.70" step="0.01">
                                <span class="form-addon-text">%</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="coef-mutation">Coefficient de mutation</label>
                            <div class="form-input-wrapper">
                                <input type="number" id="coef-mutation" class="form-input" value="2.37" step="0.01">
                                <span class="form-addon-text">coef</span>
                            </div>
                            <span class="form-help">Peut varier de 2.17 √† 2.37 selon le tribunal</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">√âmoluments du poursuivant</label>
                        <div class="grid grid-2">
                            <div class="form-group">
                                <label class="form-label" for="emoluments-poursuivant-1">0 √† 6 500 ‚Ç¨</label>
                                <div class="form-input-wrapper">
                                    <input type="number" id="emoluments-poursuivant-1" class="form-input" value="7" step="0.1">
                                    <span class="form-addon-text">%</span>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label" for="emoluments-poursuivant-2">6 500 √† 23 500 ‚Ç¨</label>
                                <div class="form-input-wrapper">
                                    <input type="number" id="emoluments-poursuivant-2" class="form-input" value="3" step="0.1">
                                    <span class="form-addon-text">%</span>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label" for="emoluments-poursuivant-3">23 500 √† 83 500 ‚Ç¨</label>
                                <div class="form-input-wrapper">
                                    <input type="number" id="emoluments-poursuivant-3" class="form-input" value="2" step="0.1">
                                    <span class="form-addon-text">%</span>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label" for="emoluments-poursuivant-4">Au-del√† de 83 500 ‚Ç¨</label>
                                <div class="form-input-wrapper">
                                    <input type="number" id="emoluments-poursuivant-4" class="form-input" value="1" step="0.1">
                                    <span class="form-addon-text">%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-2">
                        <div class="form-group">
                            <label class="form-label" for="honoraires-avocat-coef">Honoraires avocat (coef)</label>
                            <div class="form-input-wrapper">
                                <input type="number" id="honoraires-avocat-coef" class="form-input" value="0.25" step="0.01">
                                <span class="form-addon-text">x</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="honoraires-avocat-tva">TVA honoraires avocat</label>
                            <div class="form-input-wrapper">
                                <input type="number" id="honoraires-avocat-tva" class="form-input" value="20" step="1">
                                <span class="form-addon-text">%</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="publicite-fonciere-encheres">Publicit√© fonci√®re</label>
                            <div class="form-input-wrapper">
                                <input type="number" id="publicite-fonciere-encheres" class="form-input" value="0.10" step="0.01">
                                <span class="form-addon-text">%</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="frais-fixes">Frais fixes administratifs</label>
                            <div class="form-input-wrapper">
                                <input type="number" id="frais-fixes" class="form-input" value="50">
                                <span class="form-addon-text">‚Ç¨</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="avocat-enchere">Avocat - porter l'ench√®re</label>
                            <div class="form-input-wrapper">
                                <input type="number" id="avocat-enchere" class="form-input" value="300">
                                <span class="form-addon-text">‚Ç¨</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="suivi-dossier">Suivi de dossier</label>
                            <div class="form-input-wrapper">
                                <input type="number" id="suivi-dossier" class="form-input" value="1200">
                                <span class="form-addon-text">‚Ç¨</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="caution-pourcent">Caution (% mise √† prix)</label>
                            <div class="form-input-wrapper">
                                <input type="number" id="caution-pourcent" class="form-input" value="5" step="1">
                                <span class="form-addon-text">%</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="caution-restituee">Caution restitu√©e</label>
                            <div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="caution-restituee" checked>
                                    <span class="slider"></span>
                                </label>
                                <span class="form-help">Si non coch√©e, la caution est incluse dans le co√ªt total</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Le conteneur des r√©gimes fiscaux sera ins√©r√© ici dynamiquement -->
        
        <!-- R√©sultats (masqu√©s par d√©faut) -->
        <div id="results" class="hidden">
            <h2 class="mt-8">R√©sultats de la simulation</h2>
            
            <div class="grid grid-2 mt-4">
                <div class="results-card">
                    <div class="results-header">
                        <div class="flex justify-between items-center">
                            <h3 class="card-title">
                                <i class="fas fa-home mr-2"></i> Achat Classique
                            </h3>
                            <div class="tag tag-success">
                                <i class="fas fa-chart-line mr-1"></i> <span id="classique-rentabilite">--</span>
                            </div>
                        </div>
                    </div>
                    <div class="results-body">
                        <div class="results-label">Prix d'acquisition max</div>
                        <div class="results-value" id="classique-budget-max">--</div>
                        
                        <div class="results-label">Surface correspondante</div>
                        <div class="results-value" id="classique-surface-max">--</div>
                        
                        <div class="accordion">
                            <div class="accordion-header">
                                <span>D√©tail des co√ªts</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="accordion-body">
                                <table class="comparison-table">
                                    <tr>
                                        <td>Prix d'achat</td>
                                        <td class="highlight" id="classique-prix-achat">--</td>
                                    </tr>
                                    <tr>
                                        <td>Frais de notaire</td>
                                        <td id="classique-frais-notaire">--</td>
                                    </tr>
                                    <tr>
                                        <td>Commission immobili√®re</td>
                                        <td id="classique-commission">--</td>
                                    </tr>
                                    <tr>
                                        <td>Travaux</td>
                                        <td id="classique-travaux">--</td>
                                    </tr>
                                    <tr>
                                        <td>Frais bancaires</td>
                                        <td id="classique-frais-bancaires">--</td>
                                    </tr>
                                    <tr>
                                        <td>Co√ªt total du projet</td>
                                        <td class="highlight" id="classique-total">--</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="results-footer">
                        <div class="flex justify-between">
                            <div>
                                <div class="results-label">Mensualit√©</div>
                                <div id="classique-mensualite">--</div>
                            </div>
                            <div>
                                <div class="results-label">Loyer net</div>
                                <div id="classique-loyer-net">--</div>
                            </div>
                            <div>
                                <div class="results-label">Marge loyer-dette</div>
                                <div id="classique-marge">--</div>
                            </div>
                            <div>
                                <div class="results-label">Cash-flow</div>
                                <div id="classique-cashflow">--</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="results-card">
                    <div class="results-header">
                        <div class="flex justify-between items-center">
                            <h3 class="card-title">
                                <i class="fas fa-gavel mr-2"></i> Vente aux Ench√®res
                            </h3>
                            <div class="tag tag-success">
                                <i class="fas fa-chart-line mr-1"></i> <span id="encheres-rentabilite">--</span>
                            </div>
                        </div>
                    </div>
                    <div class="results-body">
                        <div class="results-label">Prix d'acquisition max</div>
                        <div class="results-value" id="encheres-budget-max">--</div>
                        
                        <div class="results-label">Surface correspondante</div>
                        <div class="results-value" id="encheres-surface-max">--</div>
                        
                        <div class="accordion">
                            <div class="accordion-header">
                                <span>D√©tail des co√ªts</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="accordion-body">
                                <table class="comparison-table">
                                    <tr>
                                        <td>Prix d'adjudication</td>
                                        <td class="highlight" id="encheres-prix-achat">--</td>
                                    </tr>
                                    <tr>
                                        <td>Droits d'enregistrement</td>
                                        <td id="encheres-droits">--</td>
                                    </tr>
                                    <tr>
                                        <td>√âmoluments du poursuivant</td>
                                        <td id="encheres-emoluments">--</td>
                                    </tr>
                                    <tr>
                                        <td>Honoraires avocat</td>
                                        <td id="encheres-honoraires">--</td>
                                    </tr>
                                    <tr>
                                        <td>Publicit√© fonci√®re</td>
                                        <td id="encheres-publicite">--</td>
                                    </tr>
                                    <tr>
                                        <td>Frais divers (fixes + avocat + suivi)</td>
                                        <td id="encheres-frais-divers">--</td>
                                    </tr>
                                    <tr>
                                        <td>Travaux</td>
                                        <td id="encheres-travaux">--</td>
                                    </tr>
                                    <tr>
                                        <td>Frais bancaires</td>
                                        <td id="encheres-frais-bancaires">--</td>
                                    </tr>
                                    <tr>
                                        <td>Co√ªt total du projet</td>
                                        <td class="highlight" id="encheres-total">--</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="results-footer">
                        <div class="flex justify-between">
                            <div>
                                <div class="results-label">Mensualit√©</div>
                                <div id="encheres-mensualite">--</div>
                            </div>
                            <div>
                                <div class="results-label">Loyer net</div>
                                <div id="encheres-loyer-net">--</div>
                            </div>
                            <div>
                                <div class="results-label">Marge loyer-dette</div>
                                <div id="encheres-marge">--</div>
                            </div>
                            <div>
                                <div class="results-label">Cash-flow</div>
                                <div id="encheres-cashflow">--</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Conteneurs pour les graphiques -->
            <div class="grid grid-2 mt-6">
                <div class="card">
                    <canvas id="chart-comparison" height="300"></canvas>
                </div>
                <div class="card">
                    <canvas id="chart-cashflow" height="300"></canvas>
                </div>
            </div>
            
            <div class="card backdrop-blur-md bg-opacity-20 border border-blue-400/10 shadow-lg transition-all mt-4">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-balance-scale"></i>
                    </div>
                    <h2 class="card-title">Comparatif des options</h2>
                </div>
                
                <div class="comparison-header">
                    <div class="flex justify-between items-center">
                        <div>
                            <strong>Achat classique vs Vente aux ench√®res</strong>
                        </div>
                    </div>
                </div>
                
                <div class="comparison-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Crit√®re</th>
                                <th>Achat Classique</th>
                                <th>Vente aux Ench√®res</th>
                                <th>Diff√©rence</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Prix d'achat</td>
                                <td id="comp-classique-prix">--</td>
                                <td id="comp-encheres-prix">--</td>
                                <td id="comp-prix-diff">--</td>
                            </tr>
                            <tr>
                                <td>Budget total</td>
                                <td id="comp-classique-total">--</td>
                                <td id="comp-encheres-total">--</td>
                                <td id="comp-total-diff">--</td>
                            </tr>
                            <tr>
                                <td>Loyer mensuel</td>
                                <td id="comp-classique-loyer">--</td>
                                <td id="comp-encheres-loyer">--</td>
                                <td id="comp-loyer-diff">--</td>
                            </tr>
                            <tr>
                                <td>Rentabilit√© nette</td>
                                <td id="comp-classique-rentabilite">--</td>
                                <td id="comp-encheres-rentabilite">--</td>
                                <td id="comp-rentabilite-diff">--</td>
                            </tr>
                            <tr>
                                <td>Cash-flow mensuel</td>
                                <td id="comp-classique-cashflow">--</td>
                                <td id="comp-encheres-cashflow">--</td>
                                <td id="comp-cashflow-diff">--</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="mt-4">
                    <div class="badge badge-primary mr-2">
                        <i class="fas fa-home mr-1"></i> Achat Classique
                    </div>
                    <span id="classique-avantages">
                        Points forts: Processus d'achat plus simple, d√©lais plus courts, moins de risques juridiques
                    </span>
                </div>
                
                <div class="mt-4">
                    <div class="badge badge-accent mr-2">
                        <i class="fas fa-gavel mr-1"></i> Vente aux Ench√®res
                    </div>
                    <span id="encheres-avantages">
                        Points forts: Prix d'achat potentiellement plus bas, absence de n√©gociation, potentiel de valorisation sup√©rieur
                    </span>
                </div>
            </div>
            
            <!-- Guide explicatif (un seul bouton plac√© strat√©giquement) -->
            <div class="text-center mt-4">
                <button id="btn-guide-cashflow" class="btn btn-outline guide-button">
                    <i class="fas fa-info-circle"></i> Comprendre le cash-flow
                </button>
            </div>
        </div>
        
        <!-- Projections de revente (dans un style am√©lior√©) -->
        <div class="card backdrop-blur-md bg-opacity-20 border border-blue-400/10 shadow-lg transition-all mt-4" id="scenarios-card">
            <div class="card-header">
                <div class="card-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <h2 class="card-title">Projections de revente</h2>
            </div>
            
            <div class="grid grid-2">
                <div class="form-group">
                    <label class="form-label">Horizon de sortie</label>
                    <select id="horizon-revente" class="form-input">
                        <option value="5">5 ans</option>
                        <option value="10">10 ans</option>
                        <option value="15">15 ans</option>
                        <option value="20" selected>20 ans</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Appr√©ciation annuelle</label>
                    <div class="form-input-wrapper">
                        <input type="number" id="appreciation-annuelle" class="form-input" value="2" step="0.1">
                        <span class="form-addon-text">%</span>
                    </div>
                </div>
            </div>
            
            <div class="text-center">
                <button id="btn-calculer-scenarios" class="btn btn-primary mt-3">
                    <i class="fas fa-calculator"></i> Calculer les projections
                </button>
            </div>
            
            <div id="resultats-scenarios" class="mt-4" style="display: none;">
                <!-- Les r√©sultats seront affich√©s ici -->
            </div>
        </div>
        
        <!-- Guide explicatif du cash-flow (masqu√© par d√©faut) -->
        <div class="card backdrop-blur-md bg-opacity-20 border border-blue-400/10 shadow-lg transition-all mt-4 hidden" id="cash-flow-explanation">
            <div class="card-header">
                <div class="card-icon">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <h2 class="card-title">Comprendre le cash-flow immobilier</h2>
            </div>
            
            <div class="explanation-content p-4">
                <div class="explanation-section">
                    <h3><i class="fas fa-question-circle text-primary-color mr-2"></i> Qu'est-ce que le cash-flow ?</h3>
                    <p>Le cash-flow est la diff√©rence entre les revenus locatifs nets et l'ensemble des charges li√©es √† votre investissement. C'est l'argent qui reste r√©ellement dans votre poche chaque mois apr√®s avoir pay√© toutes les d√©penses.</p>
                    
                    <div class="formula-box">
                        <div class="formula-title">Comment calculer le cash-flow mensuel</div>
                        <div class="formula-content">
                            <div class="formula-step">
                                <span class="step-number">1</span>
                                <span class="step-text">Loyer brut - Vacance locative = <strong>Loyer net</strong></span>
                            </div>
                            <div class="formula-step">
                                <span class="step-number">2</span>
                                <span class="step-text">Loyer net - Mensualit√© du pr√™t - Charges = <strong>Cash-flow mensuel</strong></span>
                            </div>
                            <div class="formula-note">
                                Les charges incluent : taxe fonci√®re, assurance PNO, entretien, charges non r√©cup√©rables
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="explanation-section mt-6">
                    <h3><i class="fas fa-calculator text-primary-color mr-2"></i> Comprendre les diff√©rents termes</h3>
                    
                    <div class="terms-grid">
                        <div class="term-card">
                            <div class="term-title">Loyer brut</div>
                            <div class="term-definition">Loyer total factur√© au locataire avant d√©duction des charges et de la vacance locative.</div>
                        </div>
                        
                        <div class="term-card">
                            <div class="term-title">Vacance locative</div>
                            <div class="term-definition">Provision pour les p√©riodes sans locataire (g√©n√©ralement 5% des loyers). Pour un loyer de 1000‚Ç¨/mois, on pr√©voit 50‚Ç¨/mois de vacance.</div>
                        </div>
                        
                        <div class="term-card">
                            <div class="term-title">Loyer net</div>
                            <div class="term-definition">Loyer brut moins la vacance locative. C'est le revenu sur lequel vous pouvez r√©ellement compter.</div>
                        </div>
                        
                        <div class="term-card">
                            <div class="term-title">Mensualit√©</div>
                            <div class="term-definition">Remboursement mensuel de votre pr√™t immobilier (capital + int√©r√™ts).</div>
                        </div>
                        
                        <div class="term-card">
                            <div class="term-title">Taxe fonci√®re</div>
                            <div class="term-definition">Imp√¥t local annuel divis√© par 12 pour obtenir le co√ªt mensuel.</div>
                        </div>
                        
                        <div class="term-card">
                            <div class="term-title">Charges non r√©cup√©rables</div>
                            <div class="term-definition">Charges que vous ne pouvez pas refacturer au locataire (parties communes, certaines r√©parations...).</div>
                        </div>
                        
                        <div class="term-card">
                            <div class="term-title">Entretien</div>
                            <div class="term-definition">Provision pour les travaux futurs, g√©n√©ralement calcul√©e comme 0,5% du prix d'achat par an.</div>
                        </div>
                        
                        <div class="term-card">
                            <div class="term-title">Assurance PNO</div>
                            <div class="term-definition">Assurance Propri√©taire Non Occupant, obligatoire pour couvrir les risques li√©s au bien lou√©.</div>
                        </div>
                    </div>
                </div>
                
                <div class="explanation-section mt-6">
                    <h3><i class="fas fa-money-bill-wave text-primary-color mr-2"></i> Cash-flow mensuel vs annuel</h3>
                    <p>Le cash-flow mensuel est utile pour √©valuer l'impact sur votre budget au mois le mois, tandis que le cash-flow annuel donne une vision plus globale de la performance de votre investissement.</p>
                    
                    <div class="formula-box">
                        <div class="formula-title">Du mensuel √† l'annuel</div>
                        <div class="formula-content">
                            <div class="formula-equation">
                                Cash-flow annuel = Cash-flow mensuel √ó 12
                            </div>
                            <div class="formula-example">
                                Exemple : Un cash-flow de 100‚Ç¨/mois √©quivaut √† 1 200‚Ç¨/an
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- üöÄ SCRIPTS JAVASCRIPT - Architecture modulaire -->
    <script src="./ville-search.js"></script>
    <script src="./immo-simulation.js"></script>
    <script src="./simulation-interface.js"></script>
    
    <!-- Nouvelles extensions de l'application -->
    <script src="./immo-extensions.js"></script>
    
    <!-- Fixes pour les probl√®mes d'affichage -->
    <script src="./immo-fixes.js"></script>
    
    <!-- Gestionnaire des d√©finitions fiscales (uniquement) -->
    <script src="./regime-definitions-fixed.js"></script>

    <!-- Script pour l'heure -->
    <script>
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('fr-FR');
            const timeElement = document.getElementById('marketTime');
            if (timeElement) {
                timeElement.textContent = timeString;
            }
        }

        // Mettre √† jour l'heure toutes les secondes
        setInterval(updateTime, 1000);
        updateTime(); // Appel initial
    </script>
</body>
</html>
