<!DOCTYPE html>
<html lang="fr" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradePulse - ActualitÃ©s FinanciÃ¨res</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
    <script type="module" src="aiintegration.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="actualites-style.css">
    <link rel="stylesheet" href="css/news-hierarchy.css">
    <!-- Ajout du nouveau fichier CSS pour les indicateurs d'impact -->
    <link rel="stylesheet" href="css/news-impact-indicators.css">
    <!-- Ajout du fichier CSS pour les indicateurs de sentiment ML -->
    <link rel="stylesheet" href="css/ml-sentiment-indicators.css">
    <!-- Ajout du nouveau fichier CSS dÃ©diÃ© aux Ã©vÃ©nements -->
    <link rel="stylesheet" href="events-style.css">
    <!-- Ajout du CSS pour le systÃ¨me de feedback ML -->
    <link rel="stylesheet" href="css/ml-feedback.css">
    <!-- Ajout des styles pour les mises Ã  jour en temps rÃ©el -->
    <link rel="stylesheet" href="css/classification-updates.css">
    <!-- Ajout des styles pour les correctifs d'affichage -->
    <link rel="stylesheet" href="css/news-display-fix.css">
    <!-- Ajout du nouveau CSS pour le filtre d'Ã©vÃ©nements par date -->
    <link rel="stylesheet" href="css/events-date-filter.css">
    <!-- Ajout du script events-loader.js -->
    <script src="events-loader.js"></script>
    <!-- Ajout du nouveau script de redÃ©marrage pour Ã©vÃ©nements -->
    <script src="event-renderer.js"></script>
    <!-- Ajout du script de filtre par date pour les Ã©vÃ©nements -->
    <script src="events-date-filter.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        green: {
                            400: '#00FF87'
                        }
                    }
                },
                fontFamily: {
                    sans: ['Inter', 'sans-serif']
                }
            }
        }
    </script>
</head>
<body class="dark">
    <!-- RÃ©seau de fond animÃ© -->
    <div class="network-background" id="network-background"></div>

    <!-- Cercle de date central -->
    <div class="date-circle">
        <div class="date-text" id="formatted-date">11.03.2025</div>
    </div>

    <!-- Bouton du sÃ©lecteur de thÃ¨me -->
    <div class="theme-toggle">
        <button id="theme-toggle-btn" class="theme-toggle-btn">
            <i class="fas fa-moon" id="dark-icon"></i>
            <i class="fas fa-sun" id="light-icon" style="display: none;"></i>
        </button>
    </div>

    <!-- Sidebar de navigation verticale -->
    <aside class="sidebar">
        <div class="sidebar-logo">TP</div>
        <nav class="sidebar-nav">
            <a href="actualites.html" class="nav-item active" title="ActualitÃ©s">
                <i class="fas fa-newspaper"></i>
            </a>
            <a href="portefeuille.html" class="nav-item" title="Portefeuilles">
                <i class="fas fa-chart-pie"></i>
            </a>
            <a href="dashboard.html" class="nav-item" title="Tableau de bord">
                <i class="fas fa-tachometer-alt"></i>
            </a>
            <a href="marches.html" class="nav-item" title="MarchÃ©s">
                <i class="fas fa-chart-line"></i>
            </a>
            <a href="email-preview.html" class="nav-item" title="Alertes">
                <i class="fas fa-bell"></i>
                <span class="notification-badge"></span>
            </a>
            <a href="parametres.html" class="nav-item" title="ParamÃ¨tres">
                <i class="fas fa-cog"></i>
            </a>
        </nav>
    </aside>

    <!-- Header principal -->
    <header class="main-header">
        <div class="header-left">
            <div class="logo-container">
                <div class="pulse-dot"></div>
                <a href="index.html">TRADEPULSE</a>
            </div>
            <nav class="main-nav">
                <a href="actualites.html" class="active">ActualitÃ©s</a>
                <a href="portefeuille.html?type=modere">Portefeuilles</a>
                <a href="dashboard.html">Tableau de bord</a>
            </nav>
        </div>
        <div class="header-right">
            <div class="market-status">
                <div class="market-indicator green"></div>
                <span>MarchÃ© ouvert</span>
                <span class="market-time" id="marketTime">09:45:22</span>
            </div>
            <a href="recherche.html" class="search-button ripple">
                <i class="fas fa-search"></i>
                <span>Ma question</span>
            </a>
        </div>
    </header>

    <!-- Container principal -->
    <main class="main-container">
        <!-- Nouvelle interface minimaliste -->
        <div class="p-6 md:p-8">
            <div class="w-full overflow-hidden max-w-6xl mx-auto">
                
                <!-- Header Minimaliste -->
                <div class="mb-8 text-center">
                    <h1 class="text-3xl font-bold mb-2 text-white">ACTUALITÃ‰S FINANCIÃˆRES</h1>
                    <p class="text-sm text-gray-400" id="currentDate">11 MARS 2025</p>
                </div>
                
                <!-- ActualitÃ©s critiques (Breaking News) -->
                <div class="mb-8">
                    <h2 class="text-red-500 font-bold text-xl mb-4">ðŸš¨ ACTUALITÃ‰S CRITIQUES</h2>
                    <div id="critical-news-container" class="grid grid-cols-1 gap-4">
                        <!-- Spinner de chargement -->
                        <div class="loading-state">
                            <div class="loading-spinner"></div>
                            <p>HiÃ©rarchisation des actualitÃ©s critiques...</p>
                        </div>
                    </div>
                </div>
                
                <!-- ActualitÃ©s importantes -->
                <div class="mb-8">
                    <h2 class="text-yellow-500 font-bold text-xl mb-4">ðŸ”¥ ACTUALITÃ‰S IMPORTANTES</h2>
                    <div id="important-news-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Spinner de chargement -->
                        <div class="loading-state">
                            <div class="loading-spinner"></div>
                            <p>Organisation des actualitÃ©s importantes...</p>
                        </div>
                    </div>
                </div>
                
                <!-- Section Ã‰vÃ©nements (amÃ©liorÃ©e) -->
                <div class="mb-10 p-4 glassmorphism rounded-xl" id="events-section">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-semibold text-green-400">
                            <i class="fas fa-calendar-alt mr-2"></i>Ã‰VÃ‰NEMENTS Ã€ VENIR
                        </h2>
                        <div class="flex gap-2">
                            <button id="high-impact-btn" class="text-xs text-red-500 px-2 py-1 border border-red-500 border-opacity-30 rounded filter-button">
                                Impact Ã©levÃ©
                            </button>
                            <button id="medium-impact-btn" class="text-xs text-yellow-500 px-2 py-1 border border-yellow-500 border-opacity-30 rounded filter-button">
                                Impact moyen
                            </button>
                            <button id="all-impact-btn" class="text-xs text-green-400 px-2 py-1 border border-green-400 border-opacity-30 rounded filter-button active">
                                Tous
                            </button>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4" id="events-container">
                        <div class="col-span-3 flex items-center justify-center p-6">
                            <div class="loading-spinner mr-3"></div>
                            <p class="text-gray-400">Chargement des Ã©vÃ©nements Ã©conomiques...</p>
                        </div>
                    </div>
                </div>
                
                <!-- Filtres SimplifiÃ©s -->
                <div class="mb-8">
                    <div class="flex flex-wrap gap-2 md:gap-4 justify-between items-center">
                        <!-- Filtres de catÃ©gorie -->
                        <div class="flex gap-2 overflow-x-auto pb-2 md:pb-0" id="category-filters">
                            <button class="text-xs md:text-sm px-3 py-1.5 bg-green-400 bg-opacity-10 text-green-400 border border-green-400 border-opacity-30 rounded-full font-medium filter-active" data-category="all">
                                Tous
                            </button>
                            <button class="text-xs md:text-sm px-3 py-1.5 bg-transparent text-gray-400 border border-gray-700 rounded-full font-medium" data-category="marches">
                                MarchÃ©s
                            </button>
                            <button class="text-xs md:text-sm px-3 py-1.5 bg-transparent text-gray-400 border border-gray-700 rounded-full font-medium" data-category="economie">
                                Ã‰conomie
                            </button>
                            <button class="text-xs md:text-sm px-3 py-1.5 bg-transparent text-gray-400 border border-gray-700 rounded-full font-medium" data-category="entreprises">
                                Entreprises
                            </button>
                            <button class="text-xs md:text-sm px-3 py-1.5 bg-transparent text-gray-400 border border-gray-700 rounded-full font-medium" data-category="tech">
                                Tech
                            </button>
                            <button class="text-xs md:text-sm px-3 py-1.5 bg-transparent text-gray-400 border border-gray-700 rounded-full font-medium" data-category="crypto">
                                Crypto
                            </button>
                        </div>
                        
                        <!-- Filtres avancÃ©s (Impact et Pays) -->
                        <div class="flex flex-wrap gap-2">
                            <!-- Filtre de sentiment ML -->
                            <select id="sentiment-select" class="text-xs md:text-sm px-3 py-1.5 bg-gray-800 text-gray-300 border border-gray-700 rounded-full">
                                <option value="all">Tous sentiments</option>
                                <option value="positive">Positif</option>
                                <option value="negative">NÃ©gatif</option>
                                <option value="neutral">Neutre</option>
                            </select>
                            
                            <select id="impact-select" class="text-xs md:text-sm px-3 py-1.5 bg-gray-800 text-gray-300 border border-gray-700 rounded-full">
                                <option value="all">Tous impacts</option>
                                <option value="positive">Positif</option>
                                <option value="negative">NÃ©gatif</option>
                                <option value="neutral">Neutre</option>
                            </select>
                            <select id="country-select" class="text-xs md:text-sm px-3 py-1.5 bg-gray-800 text-gray-300 border border-gray-700 rounded-full">
                                <option value="all">Tous pays</option>
                                <option value="us">Ã‰tats-Unis</option>
                                <option value="eu">Europe</option>
                                <option value="fr">France</option>
                                <option value="other">Autres</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- ActualitÃ©s gÃ©nÃ©rales - MODIFIÃ‰ POUR Ã‰LIMINER L'AFFICHAGE INDÃ‰SIRABLE -->
                <div class="mb-8">
                    <h2 class="text-gray-300 font-bold text-xl mb-4">ðŸ“° ACTUALITÃ‰S GÃ‰NÃ‰RALES</h2>
                    
                    <!-- Simplification du conteneur pour Ã©viter l'affichage non souhaitÃ© -->
                    <div id="recent-news">
                        <!-- Le contenu sera rempli dynamiquement par news-hierarchy.js -->
                        <!-- Le spinner sera ajoutÃ© par le script news-display-fix.js -->
                    </div>
                </div>
                
                <!-- Voir plus d'actualitÃ©s -->
                <div class="text-center">
                    <button class="neon-button" id="load-more-btn">
                        Voir plus d'actualitÃ©s
                    </button>
                </div>
            </div>
        </div>
    </main>

    <footer class="page-footer">
        <div class="data-source-info">
            <p><i class="fas fa-info-circle"></i> Les donnÃ©es de marchÃ© sont extraites en temps rÃ©el</p>
            <p><i class="fas fa-robot"></i> Analyses sectorielles et actualitÃ©s fournies par Perplexity Sonar</p>
            <p><i class="fas fa-brain"></i> Classification automatique par machine learning</p>
            <p><i class="fas fa-flask"></i> SystÃ¨me de feedback ML pour amÃ©lioration continue</p>
            <p><i class="fas fa-clock"></i> DerniÃ¨re mise Ã  jour: <span class="update-time" id="updateTime">09/03/2025 10:15:53</span></p>
        </div>
    </footer>

    <!-- Scripts existants -->
    <script src="js/news-hierarchy.js"></script>  <!-- PlacÃ© en premier pour s'assurer qu'il est disponible avant les autres scripts -->
    <script src="actualites.js"></script>
    <script src="js/news-filters.js"></script>
    
    <!-- Scripts ML -->
    <script src="js/ml-feedback.js"></script>
    <script src="js/ml-news-integrator.js"></script>
    <script src="js/classification-editor.js"></script>
    
    <!-- Script de mise Ã  jour en temps rÃ©el des classifications -->
    <script src="js/news-updates.js"></script>
    
    <!-- Nouveau script pour corriger les problÃ¨mes d'affichage des actualitÃ©s -->
    <script src="js/news-display-fix.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // CrÃ©er un rÃ©seau de fond
            const networkBackground = document.getElementById('network-background');
            createNetworkBackground();
            
            function createNetworkBackground() {
                // Effacer le contenu existant
                networkBackground.innerHTML = '';
                
                // Calculer le nombre de nÅ“uds en fonction de la taille de l'Ã©cran
                const numNodes = Math.min(Math.floor(window.innerWidth * window.innerHeight / 15000), 80);
                
                // CrÃ©er les nÅ“uds
                const nodes = [];
                for (let i = 0; i < numNodes; i++) {
                    const node = document.createElement('div');
                    node.className = 'node';
                    
                    // Position alÃ©atoire
                    const x = Math.random() * 100;
                    const y = Math.random() * 100;
                    
                    node.style.left = x + '%';
                    node.style.top = y + '%';
                    
                    // Certains nÅ“uds pulsent
                    if (Math.random() < 0.3) {
                        node.classList.add('pulse');
                    }
                    
                    networkBackground.appendChild(node);
                    nodes.push({ element: node, x, y });
                }
                
                // CrÃ©er des connexions entre certains nÅ“uds
                const maxConnections = Math.min(numNodes * 1.5, 80);
                for (let i = 0; i < maxConnections; i++) {
                    const nodeA = nodes[Math.floor(Math.random() * nodes.length)];
                    const nodeB = nodes[Math.floor(Math.random() * nodes.length)]
                    
                    if (nodeA !== nodeB) {
                        createConnection(nodeA, nodeB);
                    }
                }
                
                // Animer les nÅ“uds pÃ©riodiquement
                setInterval(() => {
                    nodes.forEach(node => {
                        if (Math.random() < 0.1) {
                            const newX = node.x + (Math.random() * 10 - 5);
                            const newY = node.y + (Math.random() * 10 - 5);
                            
                            node.x = Math.max(0, Math.min(100, newX));
                            node.y = Math.max(0, Math.min(100, newY));
                            
                            node.element.style.transition = 'all 5s ease';
                            node.element.style.left = node.x + '%';
                            node.element.style.top = node.y + '%';
                        }
                    });
                }, 3000);
            }
            
            function createConnection(nodeA, nodeB) {
                const connection = document.createElement('div');
                connection.className = 'connection';
                
                // Calculer l'angle et la distance entre les deux nÅ“uds
                const dx = nodeB.x - nodeA.x;
                const dy = nodeB.y - nodeA.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                const angle = Math.atan2(dy, dx) * 180 / Math.PI;
                
                // Positionner et dimensionner la connexion
                connection.style.width = distance + '%';
                connection.style.left = nodeA.x + '%';
                connection.style.top = nodeA.y + '%';
                connection.style.transform = `rotate(${angle}deg)`;
                
                networkBackground.appendChild(connection);
            }
            
            // Redimensionner le rÃ©seau lors du redimensionnement de la fenÃªtre
            window.addEventListener('resize', () => {
                createNetworkBackground();
            });
            
            // Mettre Ã  jour la date du jour
            const now = new Date();
            const day = String(now.getDate()).padStart(2, '0');
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const year = now.getFullYear();
            const formattedDate = `${day}.${month}.${year}`;
            
            document.getElementById('formatted-date').textContent = formattedDate;
            
            const options = { day: 'numeric', month: 'long', year: 'numeric' };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('fr-FR', options).toUpperCase();
            
            // Initialisation du thÃ¨me
            initTheme();
            
            // Gestion du mode sombre/clair
            const themeToggleBtn = document.getElementById('theme-toggle-btn');
            const darkIcon = document.getElementById('dark-icon');
            const lightIcon = document.getElementById('light-icon');
            
            themeToggleBtn.addEventListener('click', function() {
                document.body.classList.toggle('dark');
                document.body.classList.toggle('light');
                document.documentElement.classList.toggle('dark');
                
                // Mettre Ã  jour l'apparence du bouton
                if (document.body.classList.contains('dark')) {
                    darkIcon.style.display = 'block';
                    lightIcon.style.display = 'none';
                    localStorage.setItem('theme', 'dark');
                } else {
                    darkIcon.style.display = 'none';
                    lightIcon.style.display = 'block';
                    localStorage.setItem('theme', 'light');
                }
            });
            
            function initTheme() {
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme === 'light') {
                    document.body.classList.remove('dark');
                    document.body.classList.add('light');
                    document.documentElement.classList.remove('dark');
                    darkIcon.style.display = 'none';
                    lightIcon.style.display = 'block';
                } else {
                    document.body.classList.add('dark');
                    document.body.classList.remove('light');
                    document.documentElement.classList.add('dark');
                    darkIcon.style.display = 'block';
                    lightIcon.style.display = 'none';
                }
            }
            
            // Update market time
            function updateMarketTime() {
                const now = new Date();
                const hours = now.getHours().toString().padStart(2, '0');
                const minutes = now.getMinutes().toString().padStart(2, '0');
                const seconds = now.getSeconds().toString().padStart(2, '0');
                const timeStr = `${hours}:${minutes}:${seconds}`;
                
                const marketTimeElement = document.getElementById('marketTime');
                if (marketTimeElement) {
                    marketTimeElement.textContent = timeStr;
                }
            }
            
            updateMarketTime();
            setInterval(updateMarketTime, 1000);
            
            // Mettre Ã  jour l'heure de derniÃ¨re mise Ã  jour
            function updateLastUpdateTime() {
                const updateTimeElement = document.getElementById('updateTime');
                if (updateTimeElement) {
                    const now = new Date();
                    const dateStr = now.toLocaleDateString('fr-FR');
                    const timeStr = now.toLocaleTimeString('fr-FR', {
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit'
                    });
                    updateTimeElement.textContent = `${dateStr} ${timeStr}`;
                }
            }
            
            updateLastUpdateTime();
            
            // Gestionnaire pour les filtres d'Ã©vÃ©nements
            const highImpactBtn = document.getElementById('high-impact-btn');
            const mediumImpactBtn = document.getElementById('medium-impact-btn');
            const allImpactBtn = document.getElementById('all-impact-btn');
            
            if (highImpactBtn && mediumImpactBtn && allImpactBtn) {
                // Filtres pour les Ã©vÃ©nements
                highImpactBtn.addEventListener('click', function() {
                    toggleActiveFilter(this);
                    filterEventsByImpact('high');
                });
                
                mediumImpactBtn.addEventListener('click', function() {
                    toggleActiveFilter(this);
                    filterEventsByImpact('medium');
                });
                
                allImpactBtn.addEventListener('click', function() {
                    toggleActiveFilter(this);
                    filterEventsByImpact('all');
                });
            }
            
            function filterEventsByImpact(impactLevel) {
                const eventElements = document.querySelectorAll('#events-container .event-card');
                
                eventElements.forEach(element => {
                    if (impactLevel === 'all') {
                        element.style.display = 'flex';
                    } else {
                        const impact = element.dataset.impact;
                        element.style.display = (impact === impactLevel) ? 'flex' : 'none';
                    }
                });
            }
            
            function toggleActiveFilter(button) {
                document.querySelectorAll('.filter-button.active').forEach(el => {
                    el.classList.remove('active');
                });
                button.classList.add('active');
            }
            
            // Ajout de l'Ã©couteur d'Ã©vÃ©nement pour le filtre de sentiment
            const sentimentSelect = document.getElementById('sentiment-select');
            if (sentimentSelect) {
                sentimentSelect.addEventListener('change', function() {
                    window.NewsSystem.filterNews('sentiment', this.value);
                });
            }
            
            // Initialiser le systÃ¨me de ML aprÃ¨s le chargement des actualitÃ©s
            if (window.MLNewsIntegrator) {
                // Attendre un peu que les actualitÃ©s soient chargÃ©es
                setTimeout(() => {
                    window.MLNewsIntegrator.initMLFeedback();
                }, 1500);
            }
        });
    </script>
</body>
</html>